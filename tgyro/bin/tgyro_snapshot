# Script to generate TGYRO snapshot with date appended.
#
#!/bin/sh

# Base name to give archive
name=tgyro-snapshot

neo=`ls -d1 neo-* | sort -r`
gyro=`ls -d gyro-* | sort -r`
tgyro=`ls -d1 tgyro-* | sort -r`

set -- $gyro
gyro=$1

set -- $neo
neo=$1

set -- $tgyro
tgyro=$1
 
date=`date +%d.%m.%Y`

echo "Exporting $gyro to gyro-$date" 
cvs -Q export -DNOW -d gyro-$date $gyro

echo "Exporting $neo to neo-$date" 
cvs -Q export -DNOW -d neo-$date $neo

echo "Exporting $tgyro to tgyro-$date" 
cvs -Q export -DNOW -d tgyro-$date $tgyro

echo "Creating complete TGYRO archive" 
tar -zcf $name-$date.tgz tgyro-$date gyro-$date neo-$date 

echo "Cleaning up" 
rm -r tgyro-$date gyro-$date neo-$date

echo "Done"

scp $name-$date.tgz web:/var/www/html/web/THEORY/gyro/release/tgyro-snapshot
