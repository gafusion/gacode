dnl ######################################################################
dnl
dnl File:	tx_doxygen.m4
dnl
dnl Purpose:	Determine the location of doxygen and set the directory
dnl		for its output
dnl
dnl Version: $Id$
dnl
dnl ######################################################################

dnl ######################################################################
dnl
dnl Look for the executable.
dnl
dnl ######################################################################

AC_PATH_PROGS(SPHINX_BUILD, sphinx-build, "")
if test -z "$SPHINX_BUILD"; then
  AC_MSG_WARN(The sphinx-build utility was not found in your path.  Sphinx documentation will not be made.)
fi
AC_SUBST(SPHINX_BUILD)

dnl ######################################################################
dnl
dnl Allow setting of sphinx dir.
dnl
dnl ######################################################################

AC_ARG_WITH(sphinx-opts, [  --with-sphinx-opts=<options to Sphinx>],
	SPHINX_OPTS="$withval", SPHINX_OPTS="")
AC_SUBST(SPHINX_OPTS)
AC_ARG_WITH(sphinx-docsdir,
	[  --with-sphinx-docsdir=<where to put sphinx output>],
	SPHINX_DOCSDIR="$withval", SPHINX_DOCSDIR="")
if test -z "$SPHINX_DOCSDIR"; then
  SPHINX_DOCSDIR="sphinx_docs"
fi
AC_SUBST(SPHINX_DOCSDIR)

dnl ######################################################################
dnl
dnl Try to find jsmath/easy/
dnl
dnl ######################################################################

AC_ARG_WITH(jsmath-loadjs, [  --with-loadjs=<location of jsmath/easy/load.js>],
	JSMATH_LOADJS="$withval", JSMATH_LOADJS="")
JSMATH_SP=$SUPRA_SEARCH_PATH
for i in `echo $JSMATH_SP | tr ':' ' '`; do
  JSMATH_PATH="$JSMATH_PATH:$i/jsMath/easy"
done
if test -z "$JSMATH_LOADJS"; then
TX_PATH_FILE(JSMATH_LOADJS, load.js, [], $JSMATH_PATH)
fi
AC_SUBST(JSMATH_LOADJS)


dnl ######################################################################
dnl
dnl Try to find jsmath/easy/
dnl
dnl ######################################################################

AC_ARG_WITH(mathjaxjs, [  --with-mathjaxjs=<location of mathjax.js>],
	MATHJAXJS="$withval", MATHJAXJS="")
MATHJAX_SP=$SUPRA_SEARCH_PATH
for i in `echo $MATHJAX_SP | tr ':' ' '`; do
  MATHJAX_PATH="$MATHJAX_PATH:$i/MathJax"
done
if test -z "$MATHJAXJS"; then
TX_PATH_FILE(MATHJAXJS, MathJax.js, [], $MATHJAX_PATH)
fi
AC_SUBST(MATHJAXJS)

dnl ######################################################################
dnl
dnl This is more general then sphinx, but we need a common place to put
dnl it.
dnl
dnl ######################################################################
if echo $prefix | grep -q "webdocs"; then
	DOCS_INSTALL_DIR=$prefix
else
      DOCS_INSTALL_DIR=$prefix/docs
fi
AC_SUBST(DOCS_INSTALL_DIR)

dnl ######################################################################
dnl
dnl And summarize
dnl
dnl ######################################################################


if test -n "$config_summary_file"; then
  echo                                            >> $config_summary_file
  echo "Documentation built with" >> $config_summary_file
  TX_PRINT_VAR(SPHINX_BUILD)
  TX_PRINT_VAR(SPHINX_DOCSDIR)
  TX_PRINT_VAR(SPHINX_OPTS)
  TX_PRINT_VAR(MATHJAXJS)
dnl  TX_PRINT_VAR(JSMATH_LOADJS)
fi



