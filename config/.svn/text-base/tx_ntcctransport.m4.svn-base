dnl ######################################################################
dnl
dnl File:	tx_ntcctransport.m4
dnl
dnl Purpose:	Find the various libraries that make up the
dnl         	NTCC transport modules
dnl
dnl Version: $Id$
dnl
dnl Tech-X configure system
dnl
dnl ######################################################################

dnl-----------------------------------------------------------------------
dnl Common base search path
dnl-----------------------------------------------------------------------

if test "$parallel" = yes; then
  glf23lib=glf23mpi
  for i in `echo $SUPRA_SEARCH_PATH | tr ':' ' '`; do
    NTCCTRANSPORT_PATH=$NTCCTRANSPORT_PATH:$i/ntcc_transport-par
  done
else
  glf23lib=glf23
fi
for i in `echo $SUPRA_SEARCH_PATH | tr ':' ' '`; do
# Second is deprecated
  NTCCTRANSPORT_PATH=$NTCCTRANSPORT_PATH:$i/ntcc_transport:$i/ntcc_transport-ser
done

unset NTCCTRANPORT_INC
unset NTCCTRANPORT_LIBS
unset NTCCTRANPORT_RPLIBS
unset FOUND_NTCCTRANPORT

dnl ######################################################################
dnl
dnl Find all at once.  Add code later to find with this fails
dnl
dnl ######################################################################

if test "$parallel" = yes; then

  case "$TX_FORTRAN_MODCAP" in
    ucname-*)
      TX_LOCATE_PKG(
        [NTCCTRANSPORT],
        [$NTCCTRANSPORT_PATH],
        [GLF23_DATA_MOD.mod, NCLASS_INTERFACE.mod],
        [glf23mpi, mmm95, ifspppl, nclass, kapisn, mmm08],
        [include],
        [lib/$FC_LIBSUBDIR]
      )
      ;;
    lcname-*)
      TX_LOCATE_PKG(
        [NTCCTRANSPORT],
        [$NTCCTRANSPORT_PATH],
        [glf23_data_mod.mod, nclass_interface.mod],
        [glf23mpi, mmm95, ifspppl, nclass, kapisn, mmm08],
        [include],
        [lib/$FC_LIBSUBDIR]
      )
      ;;
  esac

else

  case "$TX_FORTRAN_MODCAP" in
    ucname-*)
      TX_LOCATE_PKG(
        [NTCCTRANSPORT],
        [$NTCCTRANSPORT_PATH],
        [GLF23_DATA_MOD.mod, NCLASS_INTERFACE.mod],
        [glf23, mmm95, ifspppl, nclass, kapisn, mmm08],
        [include],
        [lib/$FC_LIBSUBDIR]
      )
      ;;
    lcname-*)
      TX_LOCATE_PKG(
        [NTCCTRANSPORT],
        [$NTCCTRANSPORT_PATH],
        [glf23_data_mod.mod, nclass_interface.mod],
        [glf23, mmm95, ifspppl, nclass, kapisn, mmm08],
        [include],
        [lib/$FC_LIBSUBDIR]
      )
      ;;
  esac

fi

# Reverse default definition, as part is good here
AM_CONDITIONAL(HAVE_NTCCTRANSPORT, test -n "$NTCCTRANSPORT_LIBS")
if test -n "$NTCCTRANSPORT_LIBS"; then
  AC_DEFINE(HAVE_NTCCTRANSPORT, [], [Defined if NTCCTRANSPORT found])
fi

# Define for subpackages
AM_CONDITIONAL(HAVE_GLF23, test -n "$NTCCTRANSPORT_LIB_GLF23")
if test -n "$NTCCTRANSPORT_LIB_GLF23"; then
  AC_DEFINE(HAVE_GLF23, [], [Defined if GLF23 found])
fi
AM_CONDITIONAL(HAVE_GLF23MPI, test -n "$NTCCTRANSPORT_LIB_GLF23MPI")
if test -n "$NTCCTRANSPORT_LIB_GLF23MPI"; then
  AC_DEFINE(HAVE_GLF23MPI, [], [Defined if GLF23MPI found])
fi
AM_CONDITIONAL(HAVE_IFSPPPL, test -n "$NTCCTRANSPORT_LIB_IFSPPPL")
if test -n "$NTCCTRANSPORT_LIB_IFSPPPL"; then
  AC_DEFINE(HAVE_IFSPPPL, [], [Defined if IFSPPPL found])
fi
AM_CONDITIONAL(HAVE_KAPISN, test -n "$NTCCTRANSPORT_LIB_KAPISN")
if test -n "$NTCCTRANSPORT_LIB_KAPISN"; then
  AC_DEFINE(HAVE_KAPISN, [], [Defined if KAPISN found])
fi
AM_CONDITIONAL(HAVE_MMM95, test -n "$NTCCTRANSPORT_LIB_MMM95")
if test -n "$NTCCTRANSPORT_LIB_MMM95"; then
  AC_DEFINE(HAVE_MMM95, [], [Defined if MMM95 found])
fi
AM_CONDITIONAL(HAVE_NCLASS, test -n "$NTCCTRANSPORT_LIB_NCLASS")
if test -n "$NTCCTRANSPORT_LIB_NCLASS"; then
  AC_DEFINE(HAVE_NCLASS, [], [Defined if NCLASS found])
fi

dnl ######################################################################
dnl
dnl One could now add code to find any libraries not found above
dnl
dnl ######################################################################

