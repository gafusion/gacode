 
    Program Plot_Z
    !Plot z and zsq for impurities as function of te
 
    USE dislin
 
    Character *2 NAME(11),SPECIES 
    INTEGER ncrt,nout,i,j 
    REAL *8 te(200),zav(200),zsqav(200) 
    logical te_range_check 
    DATA NAME = /'ar','c ','cr','fe','he','kr','mo',      &
                 'ni','o ','si','w '/
 
    TE (1)= 1.e-3 &
    DO  j=2,3
       te(j) = 10.*te(j-1) &
    en ddo &
    DO  j= 5,200
       tE(J) = TE(J) +0.25 &
    en ddo
 
    nj = 1 ;ncrt = 6 ; nout =6 &
    DO  J = 1,11
       SPECIES = NAME(J)
       DO I=1,200
          CALL zfit (zav(j), te(j),species,nj, ncrt, nout, &
                        te_range_check)
          CALL zsqfit (zsqav, te, namei, nj, ncrt, nout, &
                                               te_range_check)

       ENDDO
       !plot for each species:
       print *,'zavg =',zavg,te


 
    enddo


 
    STOP



      subroutine zfit (zav, te, namei, nj, ncrt, nout, &
                        te_range_check)
!
      implicit  integer (i-n), real*8 (a-h, o-z)
!
! ----------------------------------------------------------------------
! this subroutine computes the average charge state for an impurity.
! coeffficents for the curve fits used were obtained from a princeton
! paper, steady state radiative cooling rates for low-density high-
! temperture plasmas (pppl-1352)
!
! name(i)    = chemical abbreviation for element
! coeff(i,1) = lower temperature range
! coeff(i,2) = upper temperature range
! coeff(i,3) ---> coeff(i,8) are the coefficients of a 5th degree
!
      parameter   (krows = 44)
      character*8  name, namei
      dimension    name(krows), coeff(krows,8)
      dimension    zav(*), te(*)
      logical te_range_check
!
! ----------------------------------------------------------------------
!
! *********  argon             **********
      data name( 1) /'ar'/, (coeff( 1,i),i = 1,8)/ &
      3.000e-02,2.000e-01,-6.35188e+01,-4.14519e+02, &
      -8.50220e+02,-8.07478e+02,-3.62126e+02,-6.18783e+01/
      data name( 2) /'ar'/, (coeff( 2,i),i = 1,8)/ &
      2.000e-01,2.000e+00, 1.59107e+01,-7.88677e-01, &
       2.87454e+00, 3.36119e+01,-3.30689e+01,-7.16260e+01/
      data name( 3) /'ar'/, (coeff( 3,i),i = 1,8)/ &
      2.000e+00,2.000e+01, 1.29638e+01, 1.83325e+01, &
      -2.83480e+01, 2.26716e+01,-9.21974e+00, 1.50713e+00/
      data name( 4) /'ar'/, (coeff( 4,i),i = 1,8)/ &
      2.000e+01,1.000e+02,-7.89001e+01, 2.93992e+02, &
      -3.55108e+02, 2.13368e+02,-6.37657e+01, 7.58257e+00/
! *********  carbon            **********
      data name( 5) /'c '/, (coeff( 5,i),i = 1,8)/ &
      2.000e-03,1.370e-02,-2.15844e+03,-4.74739e+03, &
      -4.12560e+03,-1.77619e+03,-3.79399e+02,-3.21921e+01/
      data name( 6) /'c '/, (coeff( 6,i),i = 1,8)/ &
      1.370e-02,4.047e-02, 4.00000e+00, 0.         , &
       0.         , 0.         , 0.         , 0.         /
      data name( 7) /'c '/, (coeff( 7,i),i = 1,8)/ &
      4.047e-02,1.900e-01, 9.30638e+00, 4.16782e+01, &
       1.27151e+02, 1.57530e+02, 8.45156e+01, 1.64735e+01/
      data name( 8) /'c '/, (coeff( 8,i),i = 1,8)/ &
      1.900e-01,1.000e+02, 6.00000e+00, 0.         , &
       0.         , 0.         , 0.         , 0.         /
! *********  chromium          **********
      data name( 9) /'cr'/, (coeff( 9,i),i = 1,8)/ &
      2.000e-02,2.000e-01,-7.69779e+01,-4.03142e+02, &
      -6.77843e+02,-5.42278e+02,-2.12927e+02,-3.30324e+01/
      data name(10) /'cr'/, (coeff(10,i),i = 1,8)/ &
      2.000e-01,2.000e+00, 1.99540e+01, 1.57264e+01, &
      -2.60513e+01,-5.67938e+01, 8.44905e+01, 1.33601e+02/
      data name(11) /'cr'/, (coeff(11,i),i = 1,8)/ &
      2.000e+00,2.000e+01, 1.84837e+01, 3.11439e+01, &
      -1.07363e+02, 1.69120e+02,-1.18178e+02, 3.02290e+01/
      data name(12) /'cr'/, (coeff(12,i),i = 1,8)/ &
      2.000e+01,1.000e+02,-3.75732e+01, 1.85446e+02, &
      -2.25017e+02, 1.36696e+02,-4.14507e+01, 5.01119e+00/
! *********  iron              **********
      data name(13) /'fe'/, (coeff(13,i),i = 1,8)/ &
      2.000e-03,2.000e-02,-1.07943e+03,-2.54883e+03, &
      -2.36318e+03,-1.08483e+03,-2.47337e+02,-2.24317e+01/
      data name(14) /'fe'/, (coeff(14,i),i = 1,8)/ &
      2.000e-02,2.000e-01,-3.33248e+01,-2.64547e+02, &
      -5.05432e+02,-4.27802e+02,-1.69118e+02,-2.54619e+01/
      data name(15) /'fe'/, (coeff(15,i),i = 1,8)/ &
      2.000e-01,2.000e+00, 1.90230e+01, 1.79155e+01, &
       2.39328e+01,-5.69628e+01,-1.71077e+02,-1.06708e+02/
      data name(16) /'fe'/, (coeff(16,i),i = 1,8)/ &
      2.000e+00,2.000e+01, 1.94569e+01, 2.87694e+01, &
      -7.75938e+01, 1.03931e+02,-6.41141e+01, 1.47605e+01/
      data name(17) /'fe'/, (coeff(17,i),i = 1,8)/ &
      2.000e+01,1.000e+02, 2.12208e+01, 6.89161e+00, &
      -4.07685e+00, 1.57717e+00,-5.13947e-01, 8.93418e-02/
! *********  helium            **********
      data name(18) /'he'/, (coeff(18,i),i = 1,8)/ &
      2.000e-03,1.000e-02, 2.23785e+03, 5.36958e+03, &
       5.11718e+03, 2.41851e+03, 5.66901e+02, 5.27445e+01/
      data name(19) /'he'/, (coeff(19,i),i = 1,8)/ &
      1.000e-02,1.000e+02, 2.00000e+00, 0.         , &
       0.         , 0.         , 0.         , 0.         /
! *********  krypton           **********
      data name(20) /'kr'/, (coeff(20,i),i = 1,8)/ &
      5.000e-02,2.000e-01, 2.73740e+02, 1.42106e+03, &
       3.10855e+03, 3.38963e+03, 1.82089e+03, 3.83951e+02/
      data name(21) /'kr'/, (coeff(21,i),i = 1,8)/ &
      2.000e-01,2.000e+00, 2.47735e+01, 1.09293e+01, &
      -3.98248e+01,-5.75164e+00, 1.58536e+02, 1.51381e+02/
      data name(22) /'kr'/, (coeff(22,i),i = 1,8)/ &
      2.000e+00,2.000e+01, 4.20480e+01,-1.66164e+02, &
       5.70516e+02,-7.92204e+02, 4.95793e+02,-1.16257e+02/
      data name(23) /'kr'/, (coeff(23,i),i = 1,8)/ &
      2.000e+01,1.000e+02, 6.97899e+01,-1.22590e+02, &
       1.55217e+02,-9.33267e+01, 2.74276e+01,-3.18901e+00/
! *********  molybdenum        **********
      data name(24) /'mo'/, (coeff(24,i),i = 1,8)/ &
      6.000e-02,2.000e-01, 4.99240e+01, 8.50640e+01, &
      -7.97318e+01,-3.87039e+02,-3.71884e+02,-1.12086e+02/
      data name(25) /'mo'/, (coeff(25,i),i = 1,8)/ &
      2.000e-01,2.000e+00, 2.44902e+01, 2.68426e+01, &
       1.29935e+01,-4.14538e+01,-1.49693e+02,-1.38544e+02/
      data name(26) /'mo'/, (coeff(26,i),i = 1,8)/ &
      2.000e+00,2.000e+01, 3.41244e+01, 4.46808e+00, &
      -1.30193e+02, 3.62476e+02,-3.30031e+02, 9.86647e+01/
      data name(27) /'mo'/, (coeff(27,i),i = 1,8)/ &
      2.000e+01,1.000e+02, 1.36713e+02,-2.28731e+02, &
       2.00524e+02,-7.89953e+01, 1.28869e+01,-4.47343e-01/
! *********  nickel            **********
      data name(28) /'ni'/, (coeff(28,i),i = 1,8)/ &
      3.000e-02,2.000e-01, 1.03241e+01,-6.18430e+01, &
      -1.60005e+02,-1.56411e+02,-7.15398e+01,-1.26777e+01/
      data name(29) /'ni'/, (coeff(29,i),i = 1,8)/ &
      2.000e-01,2.000e+00, 1.92973e+01, 1.59013e+01, &
       4.11513e+01,-2.44004e+01,-2.10927e+02,-1.65174e+02/
      data name(30) /'ni'/, (coeff(30,i),i = 1,8)/ &
      2.000e+00,2.000e+01, 1.74633e+01, 4.98534e+01, &
      -1.12517e+02, 1.16930e+02,-5.36758e+01, 8.53433e+00/
      data name(31) /'ni'/, (coeff(31,i),i = 1,8)/ &
      2.000e+01,1.000e+02,-8.43480e+01, 3.26564e+02, &
      -3.83686e+02, 2.26184e+02,-6.66565e+01, 7.84120e+00/
! *********  oxygen            **********
      data name(32) /'o '/, (coeff(32,i),i = 1,8)/ &
      2.000e-03,2.000e-02,-6.49058e+02,-1.65379e+03, &
      -1.64411e+03,-8.04612e+02,-1.94499e+02,-1.86055e+01/
      data name(33) /'o '/, (coeff(33,i),i = 1,8)/ &
      2.000e-02,2.000e-01,-1.13871e+01,-1.00970e+02, &
      -1.97775e+02,-1.72799e+02,-6.80264e+01,-9.44028e+00/
      data name(34) /'o '/, (coeff(34,i),i = 1,8)/ &
      2.000e-01,6.000e-01, 7.98714e+00, 6.12345e-02, &
       1.95765e-01,-3.53047e-02,-3.87677e+00, 1.24360e+00/
      data name(35) /'o '/, (coeff(35,i),i = 1,8)/ &
      6.000e-01,1.000e+02, 8.00000e+00, 0.         , &
       0.         , 0.         , 0.         , 0.         /
! *********  silicon           **********
      data name(36) /'si'/, (coeff(36,i),i = 1,8)/ &
      2.000e-03,2.000e-02, 3.80969e+03, 9.13991e+03, &
       8.70264e+03, 4.10486e+03, 9.58975e+02, 8.87920e+01/
      data name(37) /'si'/, (coeff(37,i),i = 1,8)/ &
      2.000e-02,2.000e-01, 1.26254e+01,-4.21502e+01, &
      -1.32778e+02,-1.39890e+02,-6.62081e+01,-1.19168e+01/
      data name(38) /'si'/, (coeff(38,i),i = 1,8)/ &
      2.000e-01,2.000e+00, 1.27831e+01, 4.00160e+00, &
       2.22816e+00,-1.29867e+01,-1.35309e+01, 6.70687e+00/
      data name(39) /'si'/, (coeff(39,i),i = 1,8)/ &
      2.000e+00,4.000e+00, 1.28282e+01, 5.46582e+00, &
      -1.08022e+01, 1.09604e+01,-5.61033e+00, 1.14926e+00/
      data name(40) /'si'/, (coeff(40,i),i = 1,8)/ &
      4.000e+00,1.000e+02, 1.40000e+01, 0.         , &
       0.         , 0.         , 0.         , 0.         /
! *********  tungsten          **********
      data name(41) /'w '/, (coeff(41,i),i = 1,8)/ &
      1.000e-01,2.000e-01, 1.55578e+02, 9.07526e+02, &
       2.34466e+03, 3.05061e+03, 1.99510e+03, 5.25087e+02/
      data name(42) /'w '/, (coeff(42,i),i = 1,8)/ &
      2.000e-01,2.000e+00, 2.56069e+01, 2.74645e+01, &
       1.88036e+01, 2.10978e+01,-1.77969e+01,-5.67164e+01/
      data name(43) /'w '/, (coeff(43,i),i = 1,8)/ &
      2.000e+00,2.000e+01,-8.08150e+01, 7.80711e+02, &
      -1.79349e+03, 1.85649e+03,-8.28859e+02, 1.20794e+02/
      data name(44) /'w '/, (coeff(44,i),i = 1,8)/ &
      2.000e+01,1.000e+02, 6.27044e+03,-1.82726e+04, &
       2.13281e+04,-1.23551e+04, 3.55778e+03,-4.07816e+02/
!
      data nrows/44/
!
      do 6000 j=1,nj
      tkev   = te(j)
!     out of range allowed:
      if(.not. te_range_check ) &
              tkev   = Min(tkev,100.D0) !jmp.ibm
      zav(j) = 0.0
!
      do i=1,nrows
        if (name(i) .eq. namei)  go to 2010
      end do
      write  (ncrt, 8000) namei
      write  (nout, 8000) namei
 8000 format (' FATAL ERROR in ZFIT'                              / &
              ' impurity ', a8, ' has not been added to the code' /)
      call STOP ('subroutine ZFIT: problem #1', 90)
!
 2010 if (tkev .ge. coeff(i,1))  go to 2050
      irow = i
      y    = coeff(irow,8)
      x    = LOG10 (coeff(irow,1))
      do i=8,4,-1
        y    = y * x + coeff(irow,i-1)
      end do
      zav(j) = tkev*(y/coeff(irow,1))
      go to 6000
!
 2050 i0 = i
      do i=i0,nrows
        if (tkev .ge. coeff(i,1) .and. tkev .le. coeff(i,2))  go to 2100
        if (                        name(i) .ne. namei     )  go to 9000
      end do
      go to 9000
!
 2100 irow = i
      y    = coeff(irow,8)
      x    = LOG10 (tkev)
      do i=8,4,-1
        y  = y*x+coeff(irow,i-1)
      end do
      zav(j) = y
!
 6000 continue
      return
!
! ----------------------------------------------------------------------
! fatal errors
! ----------------------------------------------------------------------
!
 9000 write  (nout, 8010)
      write  (ncrt, 8010)tkev
 8010 format (' FATAL ERROR in ZFIT'                                / &
              ' you have exceeded temperature range for curve fits' /, &
              '  tkev = ',1pe12.4)
      call STOP ('subroutine ZFIT: problem #2', 91)
!
      end

      subroutine zsqfit (zsqav, te, namei, nj, ncrt, nout, &
                                               te_range_check)
!
      implicit  integer (i-n), real*8 (a-h, o-z)
!
! ----------------------------------------------------------------------
! this subroutine computes the mean square charge state for an impurity.
! coeffficents for the curve fits used were obtained from a princeton
! paper, steady state radiative cooling rates for low-density high-
! temperture plasmas (pppl-1352)
!
! name(i)    = chemical abbreviation for element
! coeff(i,1) = lower temperature range
! coeff(i,2) = upper temperature range
! coeff(i,3) ---> coeff(i,8) are the coefficients of a 5th degree
!
      parameter       (krows = 46)
      character*8 name, namei
      logical     te_range_check
      dimension   name(krows), coeff(krows,8)
      dimension   zsqav(*), te(*)
!
! ----------------------------------------------------------------------
!
! *********  argon             **********
!
      data name( 1) /'ar'/, (coeff( 1,i),i = 1,8)/ &
      3.000e-02,2.000e-01,-9.61710e+02,-6.47898e+03, &
      -1.39467e+04,-1.37241e+04,-6.35091e+03,-1.12035e+03/
      data name( 2) /'ar'/, (coeff( 2,i),i = 1,8)/ &
      2.000e-01,2.000e+00, 2.53414e+02,-2.34631e+01, &
       7.07563e+01, 1.01411e+03,-7.34252e+02,-1.96330e+03/
      data name( 3) /'ar'/, (coeff( 3,i),i = 1,8)/ &
      2.000e+00,2.000e+01, 1.58253e+02, 5.76331e+02, &
      -8.29530e+02, 5.95453e+02,-2.05795e+02, 2.60289e+01/
      data name( 4) /'ar'/, (coeff( 4,i),i = 1,8)/ &
      2.000e+01,1.000e+02, 2.95994e+02, 6.59094e+01, &
      -7.35873e+01, 4.64761e+01,-1.56755e+01, 2.16710e+00/
!
! *********  carbon            **********
!
      data name( 5) /'c '/, (coeff( 5,i),i = 1,8)/ &
      2.000e-03,1.300e-02,-1.19723e+04,-2.59832e+04, &
      -2.22347e+04,-9.39972e+03,-1.96582e+03,-1.62847e+02/
      data name( 6) /'c '/, (coeff( 6,i),i = 1,8)/ &
      1.300e-02,4.000e-02, 1.60000e+01, 0.         , &
       0.         , 0.         , 0.         , 0.         /
      data name( 7) /'c '/, (coeff( 7,i),i = 1,8)/ &
      4.000e-02,1.900e-01,-5.23254e+01,-1.42389e+02, &
       2.75141e+02, 7.17200e+02, 4.86806e+02, 1.06456e+02/
      data name( 8) /'c '/, (coeff( 8,i),i = 1,8)/ &
      1.900e-01,1.000e+02, 3.60000e+01, 0.         , &
       0.         , 0.         , 0.         , 0.         /
!
! *********  chromium          **********
!
      data name( 9) /'cr'/, (coeff( 9,i),i = 1,8)/ &
      2.000e-02,2.000e-01,-2.33301e+03,-1.13137e+04, &
      -1.92235e+04,-1.55134e+04,-6.09525e+03,-9.41303e+02/
      data name(10) /'cr'/, (coeff(10,i),i = 1,8)/ &
      2.000e-01,2.000e+00, 4.00504e+02, 5.98513e+02, &
      -7.84260e+02,-2.27763e+03, 2.08980e+03, 4.15338e+03/
      data name(11) /'cr'/, (coeff(11,i),i = 1,8)/ &
      2.000e+00,2.000e+01, 3.29830e+02, 1.38295e+03, &
      -4.80366e+03, 7.59438e+03,-5.31360e+03, 1.35960e+03/
      data name(12) /'cr'/, (coeff(12,i),i = 1,8)/ &
      2.000e+01,1.000e+02, 1.04511e+03,-1.72775e+03, &
       2.31388e+03,-1.47903e+03, 4.59971e+02,-5.61846e+01/
!
! *********  iron              **********
!
      data name(13) /'fe'/, (coeff(13,i),i = 1,8)/ &
      2.000e-03,2.000e-02,-1.40670e+04,-3.42381e+04, &
      -3.26786e+04,-1.53740e+04,-3.57550e+03,-3.29390e+02/
      data name(14) /'fe'/, (coeff(14,i),i = 1,8)/ &
      2.000e-02,2.000e-01,-3.47441e+03,-1.76130e+04, &
      -3.16595e+04,-2.68416e+04,-1.09495e+04,-1.73609e+03/
      data name(15) /'fe'/, (coeff(15,i),i = 1,8)/ &
      2.000e-01,2.000e+00, 3.65613e+02, 7.05549e+02, &
       1.10748e+03,-2.11670e+03,-7.37044e+03,-5.03081e+03/
      data name(16) /'fe'/, (coeff(16,i),i = 1,8)/ &
      2.000e+00,2.000e+01, 3.67376e+02, 1.32217e+03, &
      -3.57325e+03, 4.79087e+03,-2.94446e+03, 6.73278e+02/
      data name(17) /'fe'/, (coeff(17,i),i = 1,8)/ &
      2.000e+01,1.000e+02,-3.24362e+02, 2.47613e+03, &
      -2.55182e+03, 1.34865e+03,-3.61953e+02, 3.92133e+01/
!
! *********  helium            **********
!
      data name(18) /'he'/, (coeff(18,i),i = 1,8)/ &
      2.000e-03,2.000e-02, 6.62735e+03, 1.58070e+04, &
       1.49612e+04, 7.01809e+03, 1.63142e+03, 1.50392e+02/
      data name(19) /'he'/, (coeff(19,i),i = 1,8)/ &
      1.200e-02,1.000e+02, 4.00000e+00, 0.         , &
       0.         , 0.         , 0.         , 0.         /
      data name(20) /'he'/, (coeff(20,i),i = 1,8)/ &
      2.000e-02,1.200e-02, 4.04302e+00, 2.10593e-01, &
       4.07570e-01, 3.90840e-01, 1.86209e-01, 3.53502e-02/
!
! *********  krypton           **********
!
      data name(21) /'kr'/, (coeff(21,i),i = 1,8)/ &
      5.000e-02,2.000e-01, 5.38182e+03, 2.74893e+04, &
       5.85402e+04, 6.26166e+04, 3.31931e+04, 6.93547e+03/
      data name(22) /'kr'/, (coeff(22,i),i = 1,8)/ &
      2.000e-01,2.000e+00, 6.14316e+02, 5.14605e+02, &
      -1.71603e+03,-6.50115e+02, 7.27807e+03, 7.34126e+03/
      data name(23) /'kr'/, (coeff(23,i),i = 1,8)/ &
      2.000e+00,2.000e+01, 1.77994e+03,-1.09043e+04, &
       3.63663e+04,-4.97846e+04, 3.08695e+04,-7.18792e+03/
      data name(24) /'kr'/, (coeff(24,i),i = 1,8)/ &
      2.000e+01,1.000e+02, 6.40233e+02, 8.44951e+02, &
      -7.68434e+02, 5.66236e+02,-2.22623e+02, 3.27402e+01/
!
! *********  molybdenum        **********
!
      data name(25) /'mo'/, (coeff(25,i),i = 1,8)/ &
      6.000e-02,2.000e-01, 2.01456e+03, 7.29892e+03, &
       9.50696e+03, 2.94308e+03,-2.49193e+03,-1.36698e+03/
      data name(26) /'mo'/, (coeff(26,i),i = 1,8)/ &
      2.000e-01,2.000e+00, 6.06171e+02, 1.34140e+03, &
       1.23873e+03,-2.32759e+03,-9.06615e+03,-7.68058e+03/
      data name(27) /'mo'/, (coeff(27,i),i = 1,8)/ &
      2.000e+00,2.000e+01, 1.03905e+03, 1.54394e+03, &
      -1.29818e+04, 3.07817e+04,-2.65536e+04, 7.73080e+03/
      data name(28) /'mo'/, (coeff(28,i),i = 1,8)/ &
      2.000e+01,1.000e+02,-1.04401e+04, 4.14475e+04, &
      -5.56599e+04, 3.64213e+04,-1.16273e+04, 1.45479e+03/
!
! *********  nickel            **********
!
      data name(29) /'ni'/, (coeff(29,i),i = 1,8)/ &
      3.000e-02,2.000e-01, 5.68427e+02, 3.33388e+02, &
      -1.01141e+03,-1.50432e+03,-7.74428e+02,-1.41858e+02/
      data name(30) /'ni'/, (coeff(30,i),i = 1,8)/ &
      2.000e-01,2.000e+00, 3.75180e+02, 6.53741e+02, &
       1.82044e+03,-7.30319e+02,-8.66849e+03,-7.22875e+03/
      data name(31) /'ni'/, (coeff(31,i),i = 1,8)/ &
      2.000e+00,2.000e+01, 2.45680e+02, 2.51595e+03, &
      -5.65959e+03, 5.82043e+03,-2.60969e+03, 3.94659e+02/
      data name(32) /'ni'/, (coeff(32,i),i = 1,8)/ &
      2.000e+01,1.000e+02,-5.46560e+02, 3.21744e+03, &
      -3.28362e+03, 1.73827e+03,-4.71450e+02, 5.19611e+01/
!
! *********  oxygen            **********
!
      data name(33) /'o '/, (coeff(33,i),i = 1,8)/ &
      2.000e-03,2.000e-02,-1.17046e+03,-3.48550e+03, &
      -3.80639e+03,-1.98106e+03,-4.99595e+02,-4.92484e+01/
      data name(34) /'o '/, (coeff(34,i),i = 1,8)/ &
      2.000e-02,2.000e-01,-1.31005e+02,-1.10200e+03, &
      -2.31452e+03,-2.14423e+03,-9.02654e+02,-1.38299e+02/
      data name(35) /'o '/, (coeff(35,i),i = 1,8)/ &
      2.000e-01,2.000e+00, 6.38084e+01, 8.67344e-01, &
       3.05377e+00, 4.64915e-01,-5.95321e+01, 1.18394e+01/
      data name(36) /'o '/, (coeff(36,i),i = 1,8)/ &
      2.000e+00,2.000e+01, 6.37958e+01, 1.18364e+00, &
      -2.98014e+00, 3.80390e+00,-2.37768e+00, 5.75365e-01/
      data name(37) /'o '/, (coeff(37,i),i = 1,8)/ &
      2.000e+01,1.000e+02,-3.63953e+02, 1.33378e+03, &
      -1.65417e+03, 1.02059e+03,-3.13304e+02, 3.82889e+01/
!
! *********  silicon           **********
!
      data name(38) /'si'/, (coeff(38,i),i = 1,8)/ &
      2.000e-03,2.000e-02, 2.19672e+04, 5.27672e+04, &
       5.02832e+04, 2.37329e+04, 5.54687e+03, 5.13678e+02/
      data name(39) /'si'/, (coeff(39,i),i = 1,8)/ &
      2.000e-02,2.000e-01, 5.40379e+02, 7.46322e+02, &
      -1.21937e+02,-8.04741e+02,-5.27067e+02,-1.08871e+02/
      data name(40) /'si'/, (coeff(40,i),i = 1,8)/ &
      2.000e-01,2.000e+00, 1.63920e+02, 1.03378e+02, &
       6.78394e+01,-3.28525e+02,-4.22436e+02, 6.23053e+01/
      data name(41) /'si'/, (coeff(41,i),i = 1,8)/ &
      2.000e+00,2.000e+01, 1.63752e+02, 1.50787e+02, &
      -2.97061e+02, 2.99360e+02,-1.51746e+02, 3.06711e+01/
      data name(42) /'si'/, (coeff(42,i),i = 1,8)/ &
      2.000e+01,1.000e+02, 3.62084e+02,-5.79022e+02, &
       7.89878e+02,-5.29103e+02, 1.74421e+02,-2.26710e+01/
!
! *********  tungsten          **********
!
      data name(43) /'w '/, (coeff(43,i),i = 1,8)/ &
      1.000e-01,2.000e-01,-1.05752e+04,-6.46137e+04, &
      -1.53578e+05,-1.80606e+05,-1.05008e+05,-2.40900e+04/
      data name(44) /'w '/, (coeff(44,i),i = 1,8)/ &
      2.000e-01,2.000e+00, 6.62079e+02, 1.41753e+03, &
       1.72297e+03, 1.88480e+03, 3.56943e+02,-1.38435e+03/
      data name(45) /'w '/, (coeff(45,i),i = 1,8)/ &
      2.000e+00,2.000e+01,-7.48175e+03, 5.66668e+04, &
      -1.21066e+05, 1.08444e+05,-3.34462e+04,-8.94193e+01/
      data name(46) /'w '/, (coeff(46,i),i = 1,8)/ &
      2.000e+01,1.000e+02, 8.06427e+05,-2.35879e+06, &
       2.74916e+06,-1.59020e+06, 4.57256e+05,-5.23409e+04/
!
      data nrows /46/
!
      do 6000 j=1,nj
        tkev     = te(j)
!     out of range allowed:
      if(.not. te_range_check ) &
              tkev   = Min(tkev,100.D0) !jmp.ibm
        zsqav(j) = 0.0
!
        do i=1,nrows
          if (name(i) .eq. namei)  go to 2010
        end do
        write (ncrt, 8000) namei
        write (nout, 8000) namei
 8000   format (' FATAL ERROR in ZSQFIT'                            / &
                ' impurity ', a8, ' has not been added to the code' /)
        call STOP ('subroutine ZSQFIT: problem #1', 92)
!
 2010   if (tkev .ge. coeff(i,1))  go to 2050
        irow = i
        y    = coeff(irow,8)
        x    = LOG10 (coeff(irow,1))
        do i=8,4,-1
          y = y*x+coeff(irow,i-1)
        end do
        zsqav(j) = tkev*(y/coeff(irow,1))
        go to 6000
!
 2050   i0 = i
        do i=i0,nrows
          if (tkev .ge. coeff(i,1) .and. &
              tkev .le. coeff(i,2))  go to 2100
          if (name(i) .ne. namei)  go to 9000
        end do
        go to 9000
!
 2100   irow = i
        y = coeff(irow,8)
        x = LOG10 (tkev)
        do i=8,4,-1
          y = y*x + coeff(irow,i-1)
        end do
        zsqav(j) = y
 6000 continue
!
      return
!
! ----------------------------------------------------------------------
! fatal errors
! ----------------------------------------------------------------------
!
 9000 write  (nout, 8010)
      write  (ncrt, 8010)
 8010 format (/ ' FATAL ERROR in ZSQFIT:'                             / &
                ' you have exceeded temperature range for curve fits' /)
      call STOP ('subroutine ZSQFIT: problem #2', 93)
!
      end
