#!/bin/bash
#==============================================================================
# profiles_gen_plot
#
# PURPOSE
#  Script to manage plotting of profiles_gen input
#==============================================================================

#==============================================================================
# Syntax validity check and help message
#
n=$#

if [ $n -eq 0 ]
then
   echo
   echo "Usage:    profiles_gen_plot [options]"
   echo
   echo "          -f <plotfile.ext>"
   echo "          Plot to plotfile.ext instead of screen." 
   echo "          <ext>=emf, eps, pdf, png, ps, raw, rgba, svg, svgz"
   echo
   echo "          -loc <Legend location: 1,2,3,4>"
   echo
   echo " PROFILE PLOTTING MODE:"
   echo 
   echo "          -plot <group>"
   echo "          <group> = geo,pow,pro (various profiles)"
   echo "                  = surf  (Miller/Fourier flux surfaces)"
   echo "                  = msurf (Miller flux surfaces)"
   echo "                  = fsurf (Fourier flux surfaces)"
   echo 
   echo "          -r <flux-surface coordinate for plotting>"
   echo "          Choices are r,r/a,rho"
   echo
   echo "          -rmin <min plot radius>"
   echo "          -rmax <max plot radius>"
   echo
   echo " FLUX-SURFACE PLOTTING MODE (-plot *surf):"
   echo 
   echo "          -n <integer>"
   echo "          Number of flux surfaces (default 16)"
   echo "          If n < 0, plot single flux surface |n|"
   echo
   echo "EXAMPLES:"
   echo
   echo "       profiles_gen_plot -plot geo"
   echo
fi

#==============================================================================
# Define variables for flag capture
#
PLOT=null
FTYPE=screen
LOC=1

# Plot options
RVAR="r"
RMIN=auto
RMAX=auto

# Surface options
N=16
#==============================================================================

#==============================================================================
# Parse command line options
#
while [ $# -gt 0 ] ; do
  case "$1" in

  -plot) shift ; PLOT="$1" ;;

  -r) shift ; RVAR=$1 ;;

  -n) shift ; N=$1 ;;
  
  -f) shift ; FTYPE=$1 ;;

  -loc) shift ; LOC=$1 ;;

  -rmin) shift ; RMIN=$1 ;;
  -rmax) shift ; RMAX=$1 ;;

  *) echo "ERROR (profiles_gen_plot): incorrect syntax." ; exit 1 ;;

  esac
  shift
done
#==============================================================================

PYROOT=$GACODE_ROOT/python/profiles_gen

#==============================================================================
# Plotting control

if [ $PLOT == null ] ; then
   exit 0
elif [[ $PLOT == *surf ]] ; then 
   python $PYROOT/plot_surf.py $PLOT $N $FTYPE 
else
   python $PYROOT/plot_profile.py $PLOT $RVAR $RMIN $RMAX $FTYPE $LOC
fi
#==============================================================================

