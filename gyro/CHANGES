Version 1.1.0

- frozen copy of 0.10.4.  Used for finite-beta APS 2001 runs, 
  and runs shown in gyro manuscript.  

** A density factor on omega_star for periodic BC was missing 
   in this version (and perhaps later).  Corrected by 1.2.3.

Version 1.1.1

- Intermediate version with real profiles.  This has a long
  way to go before being clean.  Still "unproven".

Version 1.1.2

- Fixed phi_ave bug so that zonal_moments should work 
  properly now.
- Some cleanups for vugyro, and new profile plotting 
  facility.
- c_damp set to 1.0 for both n=0 and n>0.

Version 1.1.3

- New Arakawa-type scheme for ExB nonlinearity (do_nl).

Version 1.1.4

- Many changes to profile diagnostic output.
- New write_exp_profiles.f90.
- Split read_exp_profiles.f90 into {read,make,map}_exp_profiles.f90
- Initial (probably insufficient) stab at nonunifirm grid.
- ** Incorporation of gyro2gkv utility **

Version 1.1.5

- Removed "cyclic bin" coding.

Version 1.2.0

- New profile methods (4,5)
- Fixed vugyro spectrum plotting for odd values of n_r

Version 1.2.2

- Merge with Ron's version.
- Radial grid setup uses s_grid = 1 instead of s
- Nonuniform grid in profile_method = 3 (grid_space_method =1)
- Added Kelvin-Helmholtz drive (i_KH = 1) pgamma in omega_star_v
- Added toroidal momentum transport (viscosity) im=3 is=1
- Added electron-ion energy exchange im=3 is=2
- Renamed _opslot to _private in various modules.
- ** Incorporation of vtkgyro utility **
- Frozen 26 March 2002.

Version 1.2.3

- Added GTC-type profile method (6).
- Found/added a few missing jb (geometry) factors.
- Added poloidal harmonic decomposition to vugyro.
- Large amount of reorganization in vugyro.  Changed 
  naming scheme to <file>_event.pro + <file>_see.pro.
- Added output to u.all.out for spectral analysis.
- Severe error in sparse matrix definitions corrected
  (this affected cases with n_n_1 > 1).

Version 1.2.4

- Frequency diagnostic added (in sources and vugyro).
- Raw profile printing added to vugyro.

Version 1.2.5

- Tried to "unify" s-alpha limit by setting qrat = b0 
  rather than qrat = 1.  This is to be avoided for 
  historical resons.  ABANDONED 1.2.5

Version 1.2.6

- Minor time-index fix in spectrum_np_ave_plot.
- Fixed bug (with luckily little impact) in make_omega.f90

Version 1.2.7

- Reordered call to do_collision for proper eigenvalue
  calculation.
- All-new collision method: fast, robust, low-storage,
  with a special semi-implicit finite-beta form.
- Updates to get_storage.
- Collision stencil plotting feature added to vugyro.
- Documentation added to TRANSPOSE library.

Version 1.2.8

- Removed ambipolar-fix coding from get_nlflux; this 
  was causing a bounds error for periodic/experimental.
- Added code to set nu(2) == 0 if n_field = 1.

Version 1.3.0

- ** New redistribution algorithm for NL step: SSUB library. **
- Now we scale up to 512 or 1024 processors.

Version 1.3.1

- Largely a clean-up.
- Isolated calls to MILLER library.
- Lots of cleanups to make_profiles.f90 (separate 
  make_profile_n.f90 files).
- 4X Speed-up for building gyro-operators.

Version 1.3.2

- Minor bug-fix for MILLER_allocate call in make_profiles.  This 
  did not affect results.
- New "fast" nonlinear step added (do_nlfast_x), with some attention 
  now placed on loop optimization.
- Added slightly more, improved documentation for installation.
- Fixed proc_timer to survive IBM SP compiler BUG. Recently, xlf 
  has decided to promote MPI_WTIME to quad precision if compiled 
  with -qrealsize=8.

Version 1.3.3

- Added facility for time_smoothing (via variable plot_filter).
- Merged make scripts for EAGLE (eagle.ccs.ornl.gov).

Version 1.3.4

- Experimentation with box instability problems.  Implemented 
  the "lambda-method" which adds a small parameter to the 
  Poisson equation.  This is a sloppy fix which will hopefully
  be removed from future versions.

Version 1.3.5

- Fourier-spectral Poisson solver, for both periodic and nonperiodic
  cases added.  Former uses sine/cosine series, latter uses sine 
  series for potential.  Severe timestep limitation for large 
  boxes is largely eliminated.  
- Sloppy "lambda-method" coding removed.
- Synchronized source method with spectral Poisson method.  Now, 
  the same harmonics which are exluded from the n=0 potential are 
  filtered from the n=0 source.

Version 1.4.0

- RELEASE of 1.3.5.
- Fixed bug in Poisson blending-space solver (which was in
  introduced in 1.3.1) connected with wrong arguments passed
  to gyro_doubleave.
- Make scripts for CHEETAH.

Version 1.4.1

- Changes to spectral method; now attempting to set the 
  longest density harmonics (rho_p) to zero, with small 
  residual potential phi_p.
- Generalization of source method to entire RHS.

Version 1.4.2

- Experimental version with blending-space solver for 
  finite-n.  This does not significantly improve robustness
  of low-n modes.

Version 1.4.3

- Operator regularization for Poisson equation.  The parameter 
  LAMBDA_CUTOFF is introduced to regularize the Poisson 
  equation.

Version 1.5.0

- STARTED OVER from 1.4.0.  The 1.4.1, 1.4.2 and 1.4.3 versions 
  introduced no really useful algorithms, but may have introduced 
  bugs.  So, kept only the basic n=0 spectral/source filter 
  method.

- Addition of GYRO manual (gyro_doc) in doc directory.

- Ballooning mode reconstruction fixed for s < 0.

- Version for GYRO course (2-4 Dec 2002).

- Note that there was a slight shift in the ion density 
  in make_profile_1.f90 for testing purposes.  This is 
  removed in the next version.

VERSION 1.5.1b

- New parameters added for use with MILLER equilibrium.
  (KAPPA,S_KAPPA,DELTA,S_DELTA,SHIFT)
- Parameter ALPHA_MHD_MODEL added, together with ALPHA_MHD.  
  This works with s-alpha geometry and also with MILLER 
  equilibrium (normally, MILLER takes beta_loc as input).
- Typo 'spectum' corrected in vugyro.

VERSION 1.5.3

- Major revision implementing Implicit-Explicit (IMEX) Runge 
  Kutta schemes.  
- This version removes the theta-space (and other non-blending) 
  Poisson solvers.
- There is still a problem at long wavelength which seems 
  to arise from the velocity-space discretization.

VERSION 1.5.4

- Further corrections.  This version works spectacularly for 
  linear, periodic modes.  
- Still some work to be done for nonperiodic case.  Now the 
  layer technique completely replaces the more complicated 
  buffer/damper, but still gives instability in large box 
  cases.

VERSION 1.5.5

- The construction of L_A and L_P is now done in velocity 
  space.  Blending matrices are now Hermitian.
- Still more variable changes/renaming (n_theta_grid is 
  now n_blend, for example).
- Removed in_1 indices from phi, phi_old.
- Added ion current in make_ampere_blend to fix long
  wavelength instability.  
- This version seems to work nonperiodically.  We may have
  all algorithms in place now.

VERSION 1.5.6

- More cleanups.  
- Turned off collisions for n=0.

VERSION 1.5.7

- Performance improvements.
- Reordered most large arrays: 
  (p_nek_loc,i,m) -> (m,i,p_nek_loc)
- Benchmark with pre 1.5.7 gives exact agreement (no
  algorithmic changes).

VERSION 2.0.0

- Initial IMEX version of gyro.
- Silly loop construct causing slowdown in 
  do_nlfast_match caught by Ron.

VERSION 2.0.1

- Fixed/modified restart.
- Moved interpolation operations after field solve to 
  separate files.
- Added cumulative timer.

VERSION 2.0.2

- Added ARK_324 method.

VERSION 2.0.3

- Added field sync. at end of 3rd order integrators.

VERSION 2.0.4

- Nonlinear substepping.

VERSION 2.0.5

- Abandoned 2.0.4; begin again from 2.0.3 and introduce 
  4th order ARK method.
- Added alternative source method: periodic sine-cosine 
  series.

VERSION 2.0.6

- Fine-tuning of boundary conditions/layers.

VERSION 2.0.7

- Introduced alternative radial diffusion for negative 
  sign of amplitude in input.
- Revisions of vugyro routines suitable for summary report.
- Added egyro_summary function to bin.
- Corrected MPI send size error in nlflux files.

VERSION 2.0.8

- Numerous changes and updates for vugyro, including remote 
  directory facility.

VERSION 2.0.9

- Notably, the changes to this version arose from attempts to 
  run on the Racksaver cluster with the Intel Fortran compiler.
  During the search for subtle coding errors, we found a few 
  minor things (uninitialized variables) that were corrected.
- Added "double gyroaverage trace" diagnostic to radial operator
  summary.  This allows easy spot check for adequate radial bandwidth.
- Added DocBook documentation, including documentation of profiles.
- Integrator error fixes.

VERSION 2.0.10

- Some changes to input list: removed TIME_METHOD, PROFILE_SHEAR 
  and added EXPLICIT_DAMP.  Time method is always a variant of 
  the order-2 SSP method.
- This version was released to ORNL and GYRO users.

VERSION 2.1.0

- New minor version release!
- Substepping allowed.  Originally this was introduced to allow 
  collisions to be evaluated less frequently, but ended up 
  eliminating overhead slightly even for collisionless runs.
- Lots of documentation updates.
- Reordered loops in maxwell_match (and poisson_match for 
  symmetry) to get around ostensible compiler bug in pgf90.
  (ifc still fails, by the way).

VERSION 2.1.1 (26 April 2003)

- Added dissipation option to spectral (harmonic) derivative
  method.

VERSION 2.1.2

- Fixed electromagnetic diffusion calculation.  Electron particle
  and heat flow were incorrect.

VERSION 2.1.3

- Very minor changes to sources (do_collisions, write_grids, write_h).

VERSION 2.1.4

- Mark Fahey's vectorizations and optimizations merged from 2.1.2.
- make.inc.PHOENIX added for ORNL Cray X1
- Files modified were:
  
  UMFPACK: Makefile, mc21b.f, umz2f2.f, umz2fb.f
  math   : Makefile
  src    : Makefile,get_maxwell_solution.f90,
           get_nonlinear_em_flux.f90,get_nonlinear_flux.f90,
           do_collision.f90,get_poisson_solution.f90
           do_nlfast_match.f90,gyro_ave.f90,
           do_nlfast_p.f90,gyro_bdoubleave.f90,
           get_RHS.f90,get_ampere_coll.f90,
           manage_overshoot.f90, get_delta_he.f90,
           read_restart.f90, get_field_interpolation.f90, 
           timestep_SSP_322.f90, get_gyro_h.f90,                    
           get_he.f90, make_coll_ampere_matrix.f90.
           make_maxwell_matrix.f90, make_poisson_matrix.f90

- Special MPI-IO versions of read_restart.f90 and write_restart.f90 
  created for Cray and IBM.  Old MPI_SEND/RECV versions kept for 
  linux clusters.

VERSION 2.1.5

- Interim version before 2.2.0 release [unarchived] which 
  adds impurities.

VERSION 2.2.0 (3 Sept. 2003)

- Initial release including kinetic impurities.  Fairly 
  substantial number of (straightforward) changes.

VERSION 2.2.1

- Tested for Jenko's upwind instability.  No instability of 
  n=0 with adiabatic electrons up to about 1600 rho_s.
- Added RADIAL_PROFILE_METHOD=7 for variable-shear Miller 
  equilibria.
- Added ELECTRON_METHOD=3 for ETG modes.
- Converted gyro2gkv utility (previously a separate tool) 
  from C++ to F90, and bundled with main sources.  To 
  build this, type 'make' in gyro2gkv directory.  It 
  can be run directly, or via: egyro -gkv <simdir>.
- Updates to DOCBOOK SGML documentation.
- Added "egyro -t" option to preview a run.

VERSION 2.2.2

- Small SEABORG make bugs corrected in pregyro, gyro2gkv.
- Added symbol PGAMMA for KH drive.
- Added AP_FLAG to input list to shut off a_parallel terms.
- Disable MPI-IO restart for now.

VERSION 2.3.0 (directly from 2.2.3)

- Removed call to get_nonlinear_flux every timestep, and now 
  evaulate it only at data output times.  Use time-integration
  error for monitoring blow-up now.  
- Added flag -bmaxdata:0x70000000 to SEABORG and CHEETAH 
  install to eliminate out-of-memory in MPI and MPI-IO 
  for large jobs.
- use MPI-IO for restart on PHOENIX, CHEETAH, SEABORG.
- No longer save c0_x to restart files.
- Correction stage added to collision step.  This eliminates
  a previous (weak) instability of n=0 at long wavelength.
- Modification to setup and step timers.  More information 
  for setup timing, and more logical organization of step 
  timing.
- Tried to make code more vector-friendly in places.
- Added make.ext.$EGYRO_PLAT functionality in install.
- Bundled with benchmark simdirs.

VERSION 2.3.1

- Detect a bogus parameter in INPUT and print it.
- Add separate calculation for trapped particle fluxes
  and diffusivities.
- Rewrite of MILLER routines.  Input structure has been 
  changed as well (see MILLER directory for details).

VERSION 2.4.0

- New minor version release, with many added files.
- Merged new operation modes by rew: neoclassical, 
  transport and emf. 
- Bugs probably still persist.
- Correspondingly, new flags NEO_METHOD, EMF_FLAG and 
  TRANSPORT_FLAG introduced.
- New conservative Krook collision operators added 
  for neoclassical mode.  Also available for normal 
  GK simulations.
- Improved testing via "egyro -t".
- Accuracy check in prec.out.

VERSION 2.4.1

- Fixes simple bugs in transport mode.
- This version as archived does not work 
  properly with transport mode.

VERSION 2.4.2 (10 March 2004)

- Isolation of transport routines.
- Fahey's accuracy fixes.
- Renaming of restart files.
- This version, as archived, should work properly 
  with transport mode.

VERSION 2.4.3 (29 March 04)

- Freeze with some features still under development.
- new gyro2gkv in development: to be finalized in
  future release.  These include:
  o Fixes for gyro2gkv, which was broken in 2.4.2.
  o Documentation for gyro2gkv
- Min/max k_theta*rho_s spectrum information.
- Initial attempt at radial_profile_method=7 code 
  for analytic profiles.  Will probably evolve.

VERSION 2.4.4 (21 April 04)

- Mainly a bugfix release.
- Corrects plotting bug in n_plot and e_plot moments,
  and added averaging capability for them.
- (re)inclusion of Mark F.'s optimized collision routine
  as do_pitch_angle_scatter.f90.
- Added ballooning mode reconstructions for the n_plot 
  and e_plot functions (this is neat).
- New plot file, diff_n.out, gives the n-dependence 
  of the diffusion without the excessive bulk of 
  nlflux.out (unlike nlflux.out, it is averaged over 
  radius).  Now, you must set a NLFLUX_FLAG=1 to 
  have nlflux.out printed.  

VERSION 2.4.5 -> 2.5.0 (14 May 04)

- Major cosmetic change: name truncated to gyro/GYRO, 
  rather than egyro/EGYRO.  This affects many files.
  The EGYRO name arose in 2001 when the original GYRO 
  was rewritten (E for 'explicit').
- Introduced platform-specific run scripts: 
  gyro.$GYRO_PLAT.  This is a smarter way to manage 
  execution on multiple platforms.
- Platform names (e.g., SEABORG, PHOENIX) are now 
  *all* in uppercase.  This changes (lf to LF, petrel 
  to PETREL, etc).
- Added option for "proper upwind form" in electron
  advection (dissipation on f but not on phi).  Select 
  this by making electron_orbit_upwind < 0.0.
- More X1 optimizations (mainly vectorication directives)
- All reads now only on i_proc=0.  Input data is then 
  broadcast to MPI_COMM_WORLD.
- Added include files for build with g95 (free GNU f95 
  compiler: http://g95.sourceforge.net)
- Complete re-optimization of the pitch-angle collision
  step (do_pitch_angle_sactter.f90 and related), mainly 
  for improved performance (5X) on the X1.  A small 
  improvement (<10%) seen on the IBM.

VERSION 2.5.1 (17 Jun 04)

- Normalized quasilinear diffusivity estimates (added routine 
  get_phi_squared.f90).
- Added flags to shut off the parallel motion and/or drifts:
  (KILL_I_PARALLEL_FLAG, KILL_I_DRIFT_FLAG, KILL_E_DRIFT_FLAG).

VERSION 2.5.2 (22 Sept 04)

- Important changes for nonperiodic boundary conditions:
  ION_LAYER and EXPLICIT_DAMP act on (h-phi+vp*AP).
- Field layers no longer necessary (should set to zero
  amplitude).
- Collisions again turned off for n=0 to enhance large-box 
  stability.
- Added smoothers for experimental data (see parameter 
  d_eps in read_experimental_profiles).
- Option to use RK4 for nonlinear terms (N_SUBSTEP > 0).

VERSION 2.5.3 (04 Oct 04)

- For ITG cases, it was (re)discovered that one should 
  not use ION_LAYER.  Not sure if this means that 
  ELECTRON_LAYER should also be abandoned.  Probably.
  Currently, I suggest (new defaults):

   FIELD_LAYER_GRID=1
   FIELD_LAYER_MAX=0.0
   LAYER_GRID=1
   LAYER_MAX_ION=0.0
   LAYER_MAX_ELEC=0.0
   EXPLICIT_DAMP_GRID=8
   EXPLICIT_DAMP=1.0

- SOURCE_METHOD=5 (finite-element) has been generalized 
  to a nonperiodic function.  This should be the standard.
  The minimum value for P_SOURCE is 6.
- PROFILE_METHOD=8 added for "notched profile" (this is 
  likely of no interest to anyone but the developers).

VERSION 2.5.4 (24 Oct 04)

- Ability to scale ExB rotation (DOPPLER_SCALE).
- Initial coding for impurities in experimental 
  profiles (RADIAL_PROFILE_METHOD=3).  **This is not 
  yet fully tested.**

VERSION 3.0.0

- New FFT schemes available (NL_METHOD=2), with the 
  default set at the old direct method (NL_METHOD=1).

  The added files are:

  FFTW:
   make_nl.fftw.f90, 
   do_nlfft_p.fftw.f90, 
   do_nlfft_match.fftw.f90

  IBM ESSL:
   make_nl.essl.f90, 
   do_nlfft_p.essl.f90, 
   do_nlfft_match.essl.f90

  CRAY LIBSCI:
   make_nl.libsci.f90, 
   do_nlfft_p.libsci.f90, 
   do_nlfft_match.libsci.f90

- Removed overshoot logic (and input parameters).
  For this reason, vugyro was updated for new input
  list, breaking backwards compatibility.
- Added B(theta) monotonicity check in make_profile_3.
- Added RK4 option to ITG-ae, ETG simulations through 
  INTEGRATOR_METHOD parameter, which replaces N_SUBSTEP.
  The alternatives are now 

  o ELECTRON_METHOD=1,3 (explicit integrator)

    INTEGRATOR_METHOD=1 -> RK2
    INTEGRATOR_METHOD=2 -> RK4

  o ELECTRON_METHOD=2 (semi-implicit integrator)
 
    INTEGRATOR_METHOD=1 -> IMEX
    INTEGRATOR_METHOD=2 -> IMEX+RK4
    INTEGRATOR_METHOD=3 -> IMEX+2(RK4)
    INTEGRATOR_METHOD=4 -> IMEX+3(RK4)

VERSION 3.1.0 (16 Nov 2004)

- This is a merge of Ron's 2.4.3 with my 3.0.0 (specifically,
  the src and vugyro subdirectories).
- The merge is detailed by comparing with gyro-2.4.3-ron-fix.

VERSION 3.1.1 (8 Dec 2004)

- Added special case THETA_PLOT=1 which selects a single 
  point at theta=0 to plot.  Otherwise, the plot output 
  points span [-pi,pi] as before.
- Added additional choices for OUTPUT_METHOD and fixed 
  old OUTPUT_METHOD=5, which incorrectly printed E 
  instead of N.  The choices are:

  1: POTENTIAL
  2: POTENTIAL, DENSITY, ENERGY
  3: POTENTIAL, DENSITY
  4: POTENTIAL, ENERGY
  5: DENSITY ONLY
  6: ENERGY ONLY 
  7: DENSITY, ENERGY
  8: nothing

- Fixed broken diff_n from 3.1.0 merge.
- Renamed "MILLERfuncs.out" to "geometry_arrays.out",
  and write_MILLERfuncs.f90 to write_geometry_arrays.f90.
- Removed NORM_POINT_METHOD from INPUT and in sources.
  Replaced with SPECIAL_DIFF_FLAG to switch on and off 
  the special diffusivities. 
- Fixed bug in catch_blowup.
- vugyro changes:
  = large amount of reorganization
  = added facility to plot midplane data
  = introduced generic read routine: read_array.pro
  = label switching for ETG
  = better compatibility with impurities
  = many new common blocks for data modularity

VERSION 3.1.2 (15 Dec 2004)

- Impurity fixes for experimental profiles.
- Pat Worley's timer mods added.
- Added working 9-tr directory to regression 
  tests.
- vugyro changes:
  = continued cleanups
  = reworked color table management
  = more impurity fixes; now read profiles_imp.dat

VERSION 3.1.3 (26 Jan 2005)

- Makefile updates: added PG_FFTW to specify the FFTW-enabled
  PG environment.  This _FFTW convention should be adhered to
  if FFTW is used on other platforms.  Corrected FFT stub
  information on platforms with no FFTW.  
- Updated PETREL batch scripts.
- Setting TIME_MAX to a negative number now activates
  time-stepping which halts on linear convergence error
  less than abs(TIME_MAX). 
- vugyro changes
  = flow bug fixed
  = global time-counter (t_c) reset added in  
    master options
  = PDF plotting facility revisited.  New coding is 
    more efficient and allows nbin to be selected  
    in master options widget.

VERSION 3.1.4 (24 Feb 2005)

- Added VELOCITY_OUTPUT_FLAG for printing of 
  energy and lambda-dependence of n=0 distribution
  function.
- Additional entropy diagnostics added.  Entropy 
  balance can now be measured.  Future changes will 
  probably occur for kinetic electrons and finite beta.
- Added flag EXPLICIT_DAMP_ELEC.  This effect was 
  previously active *accidentally* (the ion_layer 
  grid was being added to electrons) but appears to 
  have helped prevent electron profile flattening.
  Users should play with the small values of this 
  parameter (0.5 or so) when doing nonperiodic runs.
- Added many initializations (e.g, CPU_RHS=0.0) in 
  initialize_timestep.f90 for safety.
- Initial preps for new profile functionality which 
  *don't* affect backward compatibility. 
- vugyro changes:
  = added facility to plot entropy balance.  

  RONS PROFILE CHANGES:
  ---------------------

- Added/changed experimental profile reads for angular momentum 
  flow in Nt-m and plasma flow in MW/kev (see 
  momentum_plasma_flag = 0 or 1).
- Modified write_chi_profile.f90 to output experimental plasma 
  flow diffusivity and viscosity "eta" (angular momentum diffusivity)
  Added "diff_to_flow" for angular momentum (and heating in 
  write_chi_profiles).
- Lumped (added) convective angular momentum flow to diffusive flow.
  This will change "eta" for profile cases with finite v_phi values
  but no change for flux-tube runs which assumed v_phi = 0 when 
  pgamma not 0.
- pgamma was changed from 

                     d v_phi/dr /[c_s/a_loc] 

  to 

                   Rd(v_phi/R)/dr /[c_s/a_loc]

  This will change Kelvin-Helmholtz drive slightly for profile 
  cases.  No change for flux tube cases.
- Hardwire options/prints c_ei_exchange &  c_wall_flow available to 
  user to include classical experiemtal e-i energy exchange power 
  flows to ion and electron transport flows & add plasma wall flow 
  to beam plasma flow.  Historical defaults remain 0.
- vugyro modified to show experiemtal values of diff_ne and eta as 
  well as plasma and angular momentum flows.  The electron and ion 
  (exchange) heating "diffusivities" remain in place, but electron 
  and ion heating flows (MW) integated from 0 at inner simulation 
  radius.  Total heating flows also plotted.  Total heating should 
  be zero (or close to zero) if heating is an "exchange"
  Physics of this not yet clear.
- User must check hardwire momentum_plasma_flag = 0 or 1 in 
  read_chi_profile.pro to get a proper read.

VERSION 3.1.5 (2 May 2005)

** This version is being released prematurely in order 
to keep copies synchronized **

- Pulled ion Krook collisions out of n=0 filter (as it was 
  originally) and made active for all n.
- Fixed collision timer in do_collision.  Not sure when this 
  was first broken.
- Complete set of entropy diagnostics (time derivatives and 
  dissipation), viewable from vugyro.
- Removed deprecated source coding, and renamed the source 
  control variables:

  SOURCE_METHOD -> SOURCE_FLAG 
  P_SOURCE      -> N_SOURCE

  Here, SOURCE_FLAG=0 (no source)
                    1 (source)
                   -1 (old/deprecated sine source)
 
  and N_SOURCE starts from 1 (one full quadratic func).
  The variable RHS_nl_hold (used with old SOURCE_METHOD=2) 
  was also removed to save storage.
- Added parallel nonlinearity coding (PNL).  This is 
  localized to a single file, do_pnl.f90.  Use PNL_FLAG=1 
  (default is 0) to switch it on.
- Rewrote make_intial_h.f90.  New file is much shorter and 
  easier to read.  We may want to modify this further in 
  the future.  For now, the nominal parameters are:

  periodic: AMP_PHI_N=1.0 (or -1.0)
            AMP_PHI_0=0.0

  nonperiodic: AMP_PHI_N=-1.0
               AMP_PHI_0=0.0

  This will make the documentation look more sensible.

VERSION 3.1.6 (20 May 2005)

- A merge release.
- Some vugyro fixes.
- Facility for velocity grid output (at outboard midplane)
  added (VELOCITY_OUTPUT_FLAG=1).  Also, vugyro functionality 
  added for visualization.
- New function for read/bcast of input (in read_input).
- Removed unused variables from all routines. 
- Added flag to control usage of new initial condition routine.  
  Set USE_NEW_IC_FLAG=1 to use new IC (this is off by default).
  For compatibilty, use the old version. This will revert to the 
  new version in the near future.
  
VERSION 3.1.7 (25 May 2005) 

- Minor bug-fix in read_input.
- FFTW code fixed (removed in-place option). 
- Added FFT symbols to make.x.DROP (FFTW).
- Added FFT symbols to (new) make.x.PG_OPT64_FFTW. 
- Moved s2energy and cub_spline to gyro/math subdirectory.

VERSION 3.1.8 (4 June 2005)

- Impurity bug in make_poisson_blend, introduced in version 
  3.1.5, was fixed.  
- vugyro line color selection routine name change: original
  name 'colors.pro' changes to set_line_color.pro to avoid 
  routine name conflict.

VERSION 3.1.9 (22 July 2005)

- Merge with Ron's 3.1.6-pre branch:
  = ELECTRON_METHOD=4 coding (explicit electrons for ITG/ETG)
  = extra PNL diagnostics
  = added frequency diagnostics to vugyro
- Reintroduced old PROFILE_METHOD=2.
- Added version checking utility to vugyro (version_test.pro).  
  This is handy for maintaining backward compatibility.

VERSION 3.1.10 (8 Aug 2005)

- Corrected bug in version_test.pro.  Strings were being
  compared instead of floats.
- Added new diagnotic file (field_r0.out).  This contains 
  the fields (phi,a) at r=r0 for a specified number of 
  points in theta.  For example, to use, set

    FIELD_R0_FLAG=1
    FIELD_R0_GRID=8

  The gyro2gkv utility has also been updated to include
  this data.
- Clean-ups in diffusion_ave_see/event.pro.
- Platform files for jacquard.nersc.gov added (JACQUARD).
- corrected diagnostic print for ELECTRON_METHOD=4; the
  unused electron data is not printed.
- Some additions to midplane frequency spectral plots 
  in vugyro.

VERSION 3.1.11 (19 Sept 2005)

- * This is a beta-release for improved profile-input logic *

- Created new tool: iterdb2gyro 

- iterdb2gyro converts iterdb files to a format suitable for 
  GYRO input, either in old-style format or new format.  
- To build the converter, change directory to:
  $GYRO_DIR/tools/iterdb_read/src and type "make".
- Type 'iterdb2gyro' for help.
- Use can play with the converter using the sample iterdb 
  file $GYRO_DIR/tools/iterdb_read/iterdb.sample.
- A sample sim directory with a new format case is 
  included. 
- To use the NEW PROFILE FORMAT in GYRO runs, set 

  USE_NEW_PRO_FLAG=1

  In the new format, the file INPUT_profiles is read and 
  low-level input files are generated.  The format of the 
  new style is meant to be more readable and includes the
  facility for up to 5 ion species (although GYRO can 
  currently only include 3).
- At some point, I will deprecate USE_NEW_PROFILE_FLAG=0 (the 
  current default).
- vugyro uses the new format if the simulation version 
  was 3.1.11, or the old format if the simulation version
  was 3.1.10 or lower.
- Er data is still input via profiles_er.dat, but the will 
  become INPUT_er in a future release.
- Corrected bug in gyro2gkv related to data field_r0.out.
  This was not correctly read in 3.1.10.
- Added moments_n.out and moments_e.out (for ions) to gyro2gkv 
  converter.

VERSION 4.0.0 (6 Nov 2005)

- * This is a dramatically improved version *
- Bumped to version 4 to reflect large performance boost 
  due to new blocking scheme for SSUB library.  
  = The B1-std case is about 1.3x faster.  
  = Without collisions, it is 1.6x faster.  
- Load-balance efficiency is now calculated using the 
  "gyro -t" diagnostic.  Use this for determining 
  optimal processor count for large runs.
- Removed make_subgroup subroutine, replaced with a few 
  explicit assignments in make_MPI_grid.f90.
- New scheme for initial conditions which enforces scale 
  invariance is now the default.  Please be aware of this.  
  Behaviour for 16-mode cases with AMP_PHI_0=0.0 and 
  AMP_PHI_N>0.0 should almost the same as before.   
- Merged Ron's PNL modifications, and added Q_SCALE to 
  INPUT list.
- New diagnostic print for sparse field matrix generation.
- New diagnostic for gyroaverage bandwidth added to 
  write_input.f90. This prints to screen below box-size 
  diagnostic, in both normal runs or with 'gyro -t'.
- Fixes for new environment on JACQUARD.
  = Builds with FFTW.
  = It is now possible to use the FFT method (FFTW) for 
    the nonlinear terms (NL_METHOD=2).
  = Uses mpiexec rather than mpirun_rsh.
  = 'gyro -t' is currently broken.  

VERSION 4.0.1 (16 Nov 2005)

- Very minor touch-ups in gyro/Makefile.
- Introduced new X1E-specific direct nonlinear routines:
  do_nlfast_p.X1E.f90 and do_nlfast_match.X1E.f90.
  Mark Fahey found that swapping indices (n,i)->(i,n) 
  gives better performance.  All directives are 
  eliminated as well.  
- For X1E, a quick-fix for poor FFT performance was 
  also implemented in make_nl.libsci.f90 (an argument 
  swap in ZDFFTM_STRIDES).  All directives removed 
  here as well.
- Some batch.out format changes to accomodate very 
  large cases.
- Other minor bugfixes from 4.0.0.

VERSION 4.0.2 (13 Dec 2005)

- Added 'gyro -g' functionality (INPUT generator), which you 
  can type at the command line for more details.  This will
  generate a simulation template (INPUT) file.  The possible 
  choices are:

  = STDL_AE
  = STDL_KE
  = CYL_ZF
  = B1-std
  = B2-cy
  = B3-gtc
  
- Removed all Cray $SHORTLOOP directives on gyro-orbit 
  loops (m_gyro).
- Bugfix in PNL code (do_pitch_angle_deriv.f90 was 
  missing an update which was in Ron's 3.1.9).
  
VERSION 4.0.3 (28 Dec 2005)

- New platform-specific FFT optimizations in:
  = do_nlfft_match.libsci.f90 (by Nathan W.)
  = do_nlfft_match.fftw.f90 (by Mark F.) 
  = do_nlfft_p.libsci.f90
  = do_nlfft_p.fftw.f90 
  The _p variants were optimized by analogy 
  to the _match versions.
- Fixed bug (band(i_ion) used before it was defined) 
  in write_input.f90.
- Rewrote PNL code, using conservative form and applying 
  a correcter for density conservation.
- Improvements in gyro2gkv.

VERSION 4.0.4 (4 Jan 2006)

- Minor bugfix for pnl code (do_pnl.f90).
- Added BASSI platform files for bassi.nersc.gov.
- Removed sine-source coding entirely.

VERSION 5.0.0 (3 Feb 2006)

- Post-workshop version.

- NEW NAMING SCHEME:
  = r,q: retain radial variation in flux-tube run
  = *_s: simulation profiles (all constant in a FT run)
  = *_exp: experimental profile-grid functions (input)
  = *_p: derived functions on exp profile grid
  = tem_s -> tem_exp/tem_norm
  = den_s -> den_exp/den_norm
- DEPRECATED PROFILE FILES
  = rq.out, shape.out, profile.out, profile-2.out, profile-3.out
- NEW PROFILE FILES:
  = Organization improved:  
  = new files are: profile_sim.out, profile_exp.out, and 
    profile_vugyro.out
  = write_profile_sim: "visual" format output of most _s profiles.
  = write_profile_exp: "visual" format output of _exp profiles.
  = write_profile_vugyro: dense output of selected _s profiles.
  = iterdb2gyro modified to generate new format.
- DOCUMENTATION:
  = much improved.  See subdirectories of gyro/doc for 
    details and tex/pdf files.
- VUGYRO:
  = attempt to move private variables (used only in 
    local widgets) into private commons in order to 
    thin out the massive common in vugyro.pro.  This 
    will make adding new widgets easier, as it is 
    a move towards greater modularity.
  = unified osc_* routines.
  = fixed some midplane_* plot naming.
  = repaired old contour_* functionality.
  = bar-plot now available in each_diffusion_*.
- MISC:
  = Inverse aspect ratio now splined instead of aspect ratio.  
    This avoids a huge interpolation problem near the origin.
  = Added timestep functionality (Mikkelsen) added to 
    initialize_timestep: integer part of negative TIME_MAX is maximum 
    run time, fractional is tolerance.
  = Fixed bug in connection with grid_spacing_method: set 
    grid_spacing_method=0 if flat_profile_flag=1.
  = Fixed ion-ion pitch-angle scattering coefficient for 
    radial_profile_method/=3:
    OLD: nu_total(:,ie,1:n_ion) = 0.5*(nu_i/x**3)*(1.0)
    NEW: nu_total(:,ie,1:n_ion) = 0.5*(nu_i/x**3)*(h_coll)
- INPUT parameters:
  = Many parameter changes; see python/gyro_dict.py for a list 
    of old parameters and a list of replacements.
  = gyro_parse will recognize old parameters and point the user 
    to replacements.
- NEW runtime I/O file: run.out
  = Information previously printed to the screen is now sent
    to the file "run.out".  
  = This information is echoed to the screen at the end of 
    a 'gyro -t' run.

VERSION 5.0.1 (4 Feb 06)

- Fixed DOPPLER_METHOD bug.  In 5.0.0, ExB rotation was always 
  shut off, because of a bad if-test in get_RHS.
- Shifted _exp indices from 0:n_rho to 1:n_grid_exp.  The 
  variable i_rho is replaced by i_exp.
- New tool: gyro_loc
  = in a sim directory, this strips local parameter data
    out of run.out
  = type 'gyro_loc' for more details
- Fixed (gyro) generation and (vugyro) plotting of pgamma_s
  to properly include all species.

VERSION 5.0.2 (21 Feb 2006)

- Minor changes in vugyro:
  = reimplementation of old RMS averaging statistic
    toegther with new Mikkelsen method.
  = added back charge imbalance statistic to vugyro.
  
VERSION 5.0.3 (8 March 2006) 

- Removed white space from labels in all_profiles_event.
- Initialized grad_r_0_s in make_profiles; fixes bug.
- Added B4-iter and B5-iter to 'gyro -g' list.

VERSION 5.1.0 (17 March 2006)

- Fixed ERROR introduced in 5.0.2: In set_profile_miller,
  there was an debugging remnant: beta_unit_s(i0)*0.0 
- Implemented Carlos' index fix in vugyro for flow_i_ave_event.pro.  
  vugyro was computing the electron energy flow instead of the 
  intended electron particle flow.
- COMPLETE REWRITE of the Miller geometry routines: 
  the new subdirectory GEO replaces MILLER.  This version is 
  FULLY documented.
- Full beta (all ion species) is now computed and used in when 
  RADIAL_PROFILE_METHOD=3.  Previously, only ion #1 was used for 
  calculation of beta.
- Introduced internal pressure variable pr_s(n_spec,n_x) and 
  total -(1/p)dp/dr: dlnpdr_s(n_x).
- Fixed ballooning-mode construction for s < 0 in 
  write_balloon_mode.f90.  Improper vugyro fix removed from 
  balloon_plot.pro

VERSION 5.1.1 (26 March 2006)

- Documentation changes (gyro/doc):
  = Introduced proper Makefile.
  = Now pdf files are included in release.
  = Corrected descriptions for EPS_DLNTDR_ELECTRON and 
    EPS_DLNNDR_ELECTRON in documentation.
  = Corrected description of TIME_MAX.
- Added Fahey's platform files for XT3 (ORNL Cray XT3).
- Bugfix in GEO_do (datan -> atan).
- Bugfix in vugyro: proper calculation of boundary lines 
  for raw data plotting versus rho_hat.
- run.out now explicitly informs the user if the run is 
  ELECTROSTATIC or ELECTROMAGNETIC.
- Full beta (all ion species) is now computed and used 
  in GEO when RADIAL_PROFILE_METHOD=5.  

VERSION 5.2.0 (25 April 2006)

- iterdb2gyro
  = spline smoothing replaced by iterative scheme
  = facility for overlay of triangularity
- vugyro
  = facility for reading data from arbitrary hierarchy
    of subdirectories
  = filter all directories for presence of profile_vugyro.out
    using new utility bin/vugyro_dir_init
  = sim-remote functionality removed; now all data is 
    written directly to vugyro data directory.
- Fixed bug in make_profiles (now call GEO_write on 
  i_proc=0 only).
- Added more local parameters to write_input.  See 
  "gyro_loc" for more details. 
- Removed deprecated routines from gyro/BLEND.
- NEW Up-down asymmetric equilibrium:
  = new parameters DELTA0,S_DELTA0,DELTA1,S_DELTA1.
  = GEO routines modified.  New parameter NINT_GEO
    controls accuracy of integration.
  = ORB library totally rewritten using new iterative 
    algorithm; valid for up-down asymmetry.  New 
    parameters NINT_ORB_S and NINT_ORB_DO control 
    accuracy of integration in ORB_s and ORB_do, 
    respectively. 
- Corrected source routines (get_source_lump and 
  make_radial_fc) for nonuniform grid spacing.  There
  was previously a missing Jacobian factor in the 
  radial overlap integrals.
- Zeroed phi_dop_s(:) in make_phi_doppler.  This was 
  causing a vugyro error in zerobar_event.

VERSION 5.2.1 (5 May 2006)

- Added Mikkelsen's platform files for KITE.
- batch:
  = Added repository symbol, and access to debug queue, 
    in queue_go.PHOENIX 
- doc:
  = added definitions of DELTA0, DELTA1, S_DELTA0 and 
    S_DELTA1 to GUIDE-INPUT.

VERSION 5.3.0 (10 May 2006)

- New source algorithm.  
  = dramatically simpler coding than the old method.
  = parameter NU_SOURCE replaces SOURCE_RELAX_TIME.
  = should give similar answers for similar source rate
    (SOURCE_RELAX_TIME=50 equivalent to NU_SOURCE=0.02).  
  = removed source restart files.
  = simplified related output and generalized to all 
    species.
  = accompanying vugyro changes, cleanups.
- Updated gyro2gkv
  = Copies of read_input are no longer made.
  = Data is now imported from profile_vugyro.out

VERSION 5.3.1 (22 May 2006)

- Loop order optimization change [ (nn,i)->(i,nn) ] in 
  convolution loop to fix cache issue on Opteron and 
  Power4. The following routines were modified:
  = do_nlfast_p.f90
  = do_nlfast_match.f90
  = do_nlfast_p.X1E.f90
  = do_nlfast_match.X1E.f90
- Removed write_phi_eq (unused and redundant).
- RMS average fields:
  = collected get_ and write_ into single file
    write_field_rms.f90 (replaces write_field_rms_ave)
  = output file 'field_rms.out' replaces old (badly 
    named) 'ave_phi.out'.
- Changed MILLER->GEO in make.inc.XT3.
- Mikkelsen's GYRO_REPO option added to queue_go.PHOENIX.

VERSION 5.3.2 (6 June 2006)

- When making the domain periodic (BOUNDARY_METHOD=1) with 
  experimental profiles (RADIAL_PROFILE_METHOD=3), the box 
  size is recalibrated with norm-point shear and q.
- Loop optimizations for X1E reverted to original:
  = do_nlfast_p.X1E.f90
  = do_nlfast_match.X1E.f90
- Included Mark's optimizations (relevant for large/dense 
  problems like ITG/TEM-ETG) for 
  = get_field_interpolation.f90
  = get_gyro_h.f90  
- Added new flag UDSYMMETRY_FLAG to enforce up-down 
  symmetry for experimental profiles; diagnostics to 
  prevent use of collisions with asymmetry added.

VERSION 5.3.3 (16 August 2006)

- Improved functionality for gyro_clean (now must be
  called with -l (large) or -a (all) optiions).
- Updated gyro2gkv: diffusivity output now for 
  multiple species.
- Updated queue_go.KITE (Mikkelsen).
- Corrected DLNTDR label in write_output.
- Corrected array out-of-bounds error in GEO_interp; this 
  was causing a small error in cases with Miller geometry.
- Added platform file (IFORT_PM) for Pentium M processor 
  using Intel Fortran and Intel MKL.
- GUIDE-Technical is in transition and incomplete.

VERSION 6.0.0 (12 September 2006)

- Sparse matrix code:
  = New option for MUMPS: SPARSE_METHOD=2.
  = Original code for UMPFPACK: SPARSE_METHOD=1.
  = All calls to sparse libraries moved to single
    file sparse_solve_x.f90, where x={umfpack,mumps}.
  = Addded mumps control parameter N_MUMPS_MAX; this 
    is the maximum number of processors per subgroup 
    over which to parallelize mumps. 
  = Upgrades of platform files to point to either stub 
    files for systems without MUMPS, or to MUMPS libs. 
- Gyroaverages:
  = New option GYRO_METHOD to control accuracy of 
    certain gyroaveraged terms.
  = GYRO_METHOD=1 is original form.
  = GYRO_METHOD=2 uses velocity-space integrated J0^2  
    form, AND treats exact gyroaverage of Apar in 
    the Ampere equation for all ion species (original 
    scheme replaced all ion gyroaverages by unity).
    This changes the sparsity structure of m_ampere and 
    m_maxwell.
- Timers:
  = overall simplification of timing.
  = removed complicated field and NL weighting factors.  
  = only incremental times are printed.  
  = more detailed field-related timers. 
- ELECTRON_METHOD=4 improvements:
  = bug fix in get_entropy.f90; explicit array indices 
    1:n_kinetic added to entropy(1) definition.
  = electromagnetic operation now possible.
  = use get_field_explicit exclusively; no need for
    m_maxwell (saves storage).
- Deprecated USE_NEW_IC_FLAG; make_initial_h_old.f90 removed.
- New parameter naming for orbit upwind:
  ORBIT_UPWIND, ORBIT_UPWIND_2, ..., ORBIT_UPWIND_ELECTRON.
- Extracted velocity-space sums (previously repeated in 
  various routines) into two new routines: get_vel_sum_p 
  and get_vel_sum_a.  This improves code reusage.
- Removed m_maxwell diagnostic in write_prec in favour 
  of "invariant" quantity m_poisson acting on the 
  vector (1,1,...,1).  
- Many doc/GUIDE-Technical improvements, but many more 
  still needed.  This will be a priority in upcoming  
  releases. 
- make.inc.XT3:
  = removed -Mprof=func from FOPT, replaced with -tp k8-64.
- make.inc.PHOENIX:
  = put -sreal64 into FMATH.
  = added appropriate -R flags to FDEBUG and FBOUND.

VERSION 6.0.1 (27 Oct 2006)

- Removed incorrect test on s0 in write_ballooning_mode.f90.
  This eliminates a possible diagnostic error in ballooning
  mode plots for negative shear.
- Added new platform files (GFORTRAN_PM) for use with 
  gfortran on Pentium M.
- Fixed bounds error in make_initial_h (which occurred 
  for ELECTRON_METHOD=4).
- Fixed (again?) false catch_blowup signal created by 
  call to field solve in write_prec.

VERSION 6.0.2 (19 Nov 2006)

- Fixed MUMPS MPI grid error in make_MPI_grid.
- Removed space in electron label in read_profile_vugyro.pro.
- Added diagsnotic messages for scaling of nu_ii and nu_ei 
  by nu_ii_scale and nu_ei_scale.
- Added regression script 'gyro_reg' to suite of utilities.
  = this compares a simulation to a known solution
  = the regression test must be applied to a simdir listed 
    by 'gyro -g'.
- Renaming of some cases, and overall reformatting, for 
  entries in 'gyro -g'.
- Added platform files for Blue Gene/L (UBGL).

VERSION 6.0.3 (11 Dec 2006)

- Added Debye physics to Poisson equation
  = If RADIAL_PROFILE_METHOD /= 5, specify it with 
    LAMBDA_DEBYE.
  = If RADIAL_PROFILE_METHOD = 3, it is automatically 
    computed and scaled with LAMBDA_DEBYE_SCALE. 
- Added new INPUT parameters to control initial conditions:
  = AMP_PHI_STUDY (amplitude of study mode)
  = N_STUDY (mode index of study mode: 1 to TOROIDAL_GRID)
  = If N_STUDY=0, the study mode is ignored.
- Added new INPUT parameter (RADIAL_GRID_OFFSET) to 
  shift location of norm point inside radial domain.
- Added check for nonpositive elements of experimental 
  density profiles.
- GEO:
  = Fixed minor error in calculation of GEO_grad_r0.
- vugyro:
  = Fixed minor bug in read_profile_vugyro.pro (n0 -> n_0).
  = Improved numerical derivative functions scalar_deriv
    and vector_deriv (added periodic option).
  = Added option to control field shear versus n 
    (midplane_deriv_*).
- math:
  = Rewrote cub_spline.f90 from scratch.  Code is cleaner 
    and now calls LAPACK to perform tridiagonal solve.
    Interpolation stage more efficient.
 
VERSION 6.0.4 (14 Dec 2006)

- Fixed diagnostic error in make_phi_doppler: removed extra
  factor of b_unit_s in definition of gamma_eb_s.
- Fixed text for units of csda_norm in write_input.f90
- Added Mikkelsen's fix for restarts in write_timing.f90.
- Change to JACQUARD optimization flags: -O2 -> -Ofast.
- iterdb2gyro:
  = improved treatment of Er fit near rho=1 (linearly extrapolate 
    raw data to rho=1) in read_er.f90.
  = use new cub_spline.f90 routine (from 6.0.3) in read_er.f90.
  = autodetection of number of points is raw Er data.
- install:
  = modification of make.inc.x structure to include new 
    symbol LMATH (for use in tools).

VERSION 6.0.5 (21 Dec 2006)

- Added Holland's G95_OSX platform files.
- radial_profile_method=3 (experimental profiles) now 
  compatible with electron_method=4 (gyrokinetic electrons).
  Operationally, experimental electron profiles are mapped 
  to the last ion.
- Electron collisions now work for electron_method=4 (electron
  collision frequency mapped onto last ion).
- In get_storage.f90, call alloc_add(m_maxwell) only 
  for electrom_method=2 (fixes KITE error).
- Repair main.inc.KITE (LAPACK symbol lost in 6.0.4).
- Modified definition of Hahm-Burrell shearing rate 
  diagnostic print in write_profile_sim.f90.
- GEO:
  = removed print_flag from GEO_do parameter list (this 
    was omitted in error from all external calls).

VERSION 6.1.0 (18 Jan 2007, Mark Fahey)

- NEW SUBROUTINIZED VERSION (made main program a subroutine)
  = Moved most of BigScience.f90 into do_gyro.f90
  = Moved most of globals.f90 into gyro_globals.f90
    + Updated every file to use gyro_globals
  = Created new BigScience.f90 that calls do_gyro with comm and path
  = Created BigScience_globals.f90 used by BigScience.f90
  = Updated src/Makefile to include these files
- Renamed MPI_COMM_WORLD to GYRO_COMM_WORLD in all src/*.f90 files
  = except BigScience.f90
- Added logic to get path to input and for output
  = New subroutine is get_inputpath.f90
  = BigScience.f90 calls get_inputpath
  = BigScience_globals.f90 includes "path" variable
  = Added get_inputpath.o to src/Makefile
  = Modified get_input.f90 and get_input_extra.f90 to use path.
  = This means INPUT will need path and gyro_parse will need to make
       put some files in the new "path"!!!!
  = Updated all files that created an .out file (many!)
    + Preprended file name with path
- Updated make.ext.XT3 to use mpiio for restarts
- Removed annoying "print *,collision_flag" from get_storage.f90.

VERSION 6.1.1 (Jan 2007)

- Fixes to ensure proper operation of electron collisions when
  using electron_method=3 (adiabatic ions).
- Added diagnostic for part of ExB shear subtracted off in 
  make_phi_doppler. 
- Added code to read z_mag_axis_exp (magnetic axis elevation) 
  from INPUT_profiles.
- Fixed diagnostic bug in GEO.out (angle was improperly matched 
  with function).
- Fixed path resolution in write_diffusivity files.

VERSION 6.2 (2 March 2007)

- TGYRO-related changes (Fahey):
  = Removed comm and path argument variables from do_gyro.
  = Added optional skip arguments to do_gyro.  
  = Added interface block to BigScience.f90 for do_gyro.
  = Moved SRC_DIR and LIBS (renamed GYRO_LIBS) into Makefile
    and deleted these from every install/make.inc.* file.
  = Modifed src/Makefile to archive gyro only objects into gyro_lib.a.
  = Put driver objects into their own variable BIGSCIENCE_OBJS, 
    and modified compile line for executable.
  = Modified GYRO_LIBS in Makefile to contain gyro_lib.a
  = Removed old transport-related files from gyro/src.
  = Added new routine cleanup_gyro.f90 for final deallocation 
    of arrays.
- Special diffusivity-related changes:
  = Cleaned up s_diff moments and added sp_diff parts
    for toroidal angular momentum transport and turbulent 
    heating.  This required m0->m, loops and storage 
    change in make_omegas.f90
  = Added write_sp_diffusivity.f90 and write_sp_diffusivity_i.f90
  = Added mach_method for finite mach number drive in 
    omega_d1,omega_dr: 
    MACH_METHOD=1: (default) OFF
    MACH_METHOD=2: ON
  = Added MACH input parameter (mach0 internal).
  = Introduced flag SPECIAL_DIFF_FLAG.  At present, this will 
    only work with ELECTRON_METHOD=2:
    SPECIAL_DIFF_FLAG=0: (default) no printing of special diff.
    SPECIAL_DIFF_FLAG=1: print special diff files.
  = Fixed sp_diff heating for exchange check. 
  = Made mach multi-species.
  = New INPUT parameters MACH_SCALE and PGAMMA_SCALE.
- GEO:
  = Added variable rmajDrmaj0 in GEO
- tools/gyro2gkv (Wang)
  = Updated gyro2gkv so it can be run with a flag to output the 
    full (electrostatic) potential.  It will output parallel dynamics 
    based on the value of N_THETA_PLOT (a netCDFvariable 'potential-full' 
    will be made instead of 'potential-r' with an extra dimension).  
    It is run as follows: gyro2gkv -f <sim_dir>
  = Without the flag, gyro2gkv runs as before.
- tools/input:
  = Added N5-d3d case to input database.  This is the first 
    template to include experimental profiles.
- vugyro:
  = Some improvements to time_trace_x.pro files, including 
    data output and introduction of new file time_trace_plot.pro
    to isolate plotting commands.
- Fixed major bug related to c_nl.  The scalar value was used
  incorrectly in FFT variants of do_nlfft_x.  Now, only the 
  radial form c_nl_i(:) is used.  This also fixes a bug which 
  occurred when RADIAL_PROFILE_METHOD=3 and BOUNDARY_METHOD=1.

VERSION 6.3 (1 May 2007)

- TGYRO-related changes:
  = Added new INPUT variable SILENT_FLAG to suppress writing 
    to standard output.
    SILENT_FLAG=0 (default, print to stdout)
    SILENT_FLAG=1 (no printing).
- gyro/BLEND:
  = Removed old parameter i_print from BLEND_init.
- New format for INPUT_profiles:
  = New data block for vpol_exp data (see web documentation).
  = iterdb2gyro code modified accordingly (currently writes 
    zeros in new slots).
  = Added parameter n_indx in bin/iterdb2gyro and 
    tools/src/iterdb_read/src/iterdb_to_gyro.f90 to 
    simplify addition of new parameters.
- Added functionality for plotting eikonal nu(r,theta):
  = Removed parameter GEO_ARRAY_PRINT_FLAG
  = Added parameter THETA_MULT (internal n_theta_mult) 
    so that nu is written to n_theta_plot*n_theta_mult 
    theta-points at every simulation radius.
  = Output is written to geometry_arrays.out, from code 
    in write_geometry_arrays.f90
- Added new tool for INPUT_profiles generation: pro2gyro
  = New directory tools/pro_read.
  = Type pro2gyro for more information.
- Corrected possible div by zero errors in write_profile_vugyro.
- Generalized collision handling to multiple ions.  
  = Pitch-angle scattering on all ions is included.
  = Currently, operator is fully conservative on each 
    ion individually.  
  = Future implementation should allow control over 
    desired conservation rules. 
  = NI_OVER_NE, NI_OVER_NE_2, etc now act as multipliers 
    on data in INPUT_profiles.
- Momentum transport diagnostics:
  = Created new routine make_experimental_neo_profiles (split 
    off from make_experimental_profiles) to explicitly handle 
    large amount of code related to neoclassical rotation 
    and experimental profiles.
  = progammed vpol_exp into v_par i.e. pgamma and mach
  = phi_gamma added (= pgamma except RADIAL_PROFILE_METHOD=3)

VERSION 6.4 (21 August 2007)

- Added ATLAS platform files for atlas.llnl.gov.
- Added FRANKLIN platform files for franklin.nersc.gov.
- Added GFORTRAN_OSX platform files (Fahey).
- Changed from all-processor read to read on i_proc=0 followed 
  by MPI_BCAST in make_profile_6.
- Removed deprecated internal parameter transport_flag.
- Added ELECTRON_OVERLAY_METHOD, active when ELECTRON_METHOD=4: 
  = ELECTRON_OVERLAY_METHOD=1: GK electrons defined by ion parameters.
  = ELECTRON_OVERLAY_METHOD=1: GK electrons defined with electron
    parameters.
- Fixed path for tgyro in read_experimental_profiles.
- Added missing variable to deallocate in GEO_alloc.f90.
- Added input parameters to do_gyro:
 = skipinput (to skip read_input)
 = skipinit (to skip matrix initialization code)
 = skipprof (to skip experimental profile read)
- Fixed two (possible) cases of uninitialized variables: 
  bt_exp and omega_eb_0 (V. Zecca). The uninitialized case was 
  restricted to a diagnostic print for which the parameters 
  were unused.

VERSION 6.5 (28 November 2007)

- TGYRO:
  = ** Large number of TGYRO-related cleanups and mofifications. ** 
- Fixed dimension error (n_spec -> is) in make_nonlinear_flux_x.f90.
  Error caught by (V. Zecca).
- Replaced nonstandard edit '$' in print statements with 
  write(6,*,advance='no') in read_restart.f90 (suggested by V. Zecca). 
- Modified gyro_summary.
  = Now, run.out is echoed rather than input.dat.
- Replaced RESTART_SKIP_STEP with RESTART_DATA_SKIP to make 
  restarts on multiples of TIME_SKIP.
- GEO:
  = Added new (neoclassical) functions to calculation.
- MATH:
  = Moved energy grid/weight generation to new file (energy_integral)
    in MATH.
  = Added option to improve Region 2 integration: select in GYRO 
    with new flag ENERGY_METHOD=2.
- VUGYRO
  = Reads TGYRO output file.
  = Added Chris Holland's new midplane diagnostics (see VUGYRO
    documentation):
    1. diffusion_i_rt,
    2. midplane_rms_flucamp, 
    3. midplane_corr, 
    4. midplane_avg_kspect tools,
    5. updated midplane_mapper to include temperature fluctuations.

VERSION 7.0 (3 March 2008)

- Added code to test for sufficient buffer width (write_input).
- Full 2-D Miller diagnostics now available in geometry_arrays.out;
  resolution adjustable with THETA_MULT (see also vugyro documentation)
- Neoclassical ion energy flux:
  = Uses Chang-Hinton formula (see gyro/math/neo_theory.f90)
  = Output to file diff_i_ch.out; plotted in vugyro.
- Added various tests of quasilinear therory (QL) with various norms 
  =  LINDIFF_METHOD = 4,5,6,7,8
- Added nonlinear transfer (entropy rate and entropy n,p spectrum outputs).
- Added E_parallel to linear ballooning mode data output.
- Improved computation of derivatives of blending functions:
  = Affects array blend_prime_plot().
  = Use analytic derivatives of blending funcs. rather than 
    finite-difference approximation.
- Updated install/make.inc.GFORTRAN_PM to parallel GFORTRAN_P4.
- VUGYRO
  = Chang-Hinton diffusivity added to diffusion_i_ave and 
    flow_i_ave widgets.
  = Improvements/additions to geometry plotting widget.
  = (CH) Added _EXTRA keyword to pass commands to user_control, 
     and option for a manually-selected simulation directory.
  = Added option for manual directory selection.
  = Added QL test buttons in diff_n spectra
  = Added nonlinear transfer n,p spectrum plots
  = Added re-norm function to ballooing mode plots
  = Added E_parallel to kinear ballooning mode plots
- bin
  = Improved parsing for "-g" and "-t" options in bin/gyro script.
  = Better handling of '-t' option (no overwrite of VERSION_tag).
- BLEND:
  = Added derivative function BLEND_Fp, together with primitive 
    derivatives BLEND_f2p, BLEND_f3p and BLEND_f4p.
- tools:
  = Enhancements to gyro_summary (see command for details).

VERSION 7.1 (29 April 2008)

- Fixed calculation of jstar for box_multiplier < 1.0 in make_simulation_box. 
- Cleaned up nonlinear transfer diagnostics, and added flag to control 
  execution.  To enable, set NONLINEAR_TRANSFER_FLAG=1.
- tools:
  = Added code to generate additional diagnostic data file 
    (INPUT_profile2) write in iterdb_read/src.
  = Extra file existence checks in gyro2gkv.
  = Made gyro2gkv run and produce data in local directory,
    give source data in external directory.  
- Added new interface subroutine gyro_sub.f90 to facilitate 
  calling GYRO from other codes.
- Added new parameters L_X and L_Y to enable specification of 
  box size explicitly (in units of rho_s).  This functionality 
  is enabled by setting BOX_MULTIPLIER=-1.0.
- Adding missing deallocations to cleanup_gyro.f90; then changed 
  name to gyro_cleanup.f90.

VERSION 7.2 (11 July 2008)

- Added platform files for Chalmers workstations: GFORTRAN_CORE2.
- Added platform files for new banach: GFORTRAN_PENRYN.
- Removed ORB library, placed in src.
- Makefile structure simplified (no more repeated appearances 
  of gyro_lib.a required for gyro/tgyro build). 
- Removed some ancient platform files (CHEETAH, RAM, EAGLE) and 
  modified behaviour of exec and batch scripts to make them 
  function also for TGYRO.
- EXPRO:
  = Added new directory EXPRO for reading experimental profile 
    data (based on INPUT_profiles).
- python:
  = Added cpu function to compute max CPU count.
- tools:
  = Added new template directories (for weak scaling and 
    simple Cyclone base cases).
- vuGyro:
  = Added tool to plot (kr,omega) spectra of n=0 fluctuations.

VERSION 7.3 (24 August 2008)

- Introduced write_distributed_* routines for writing arrays which 
  are distributed (with separate n's in each subgroup). 
  = Changed spectrum.out to kxkyspec.out with new index ordering.
    This is required when using new write_distributed_* routines.
- Added series of gyro_alloc_* routines to manage array allocation 
  and deallocaiton in a clean (symmetric) way.
- Significant reorganization of code in make_profiles to allow for
  proper calculation of local ExB shearing rate in case when 
  profiles are flattened.  Now, make_phi_doppler is called before
  profiles are flattened, and then additional profiles must be 
  flattened (for example, gamma_eb_s).
- Rewrote velocity-space diagnostic to compute energy dependence
  of fluxes (get_nonlinear_flux_velocity) at central radius.  
  Output is put in diff_velocity.out.  IDL upgraded to match.
- Reorganized quasilinear normalizations in get_diffusivity 
  for improved readability.
- Deprecated code for NEO_METHOD > 2.
- Restructure and "demystification" of code in do_collision;
  accompanied by updated documentation in tech. manual.
- Added platform files for Garching IBM (REGATTA) (not a 
  Regatta, despite the name). 
- tools:
  = Significant restructuring of Makefile system, coupled more 
    tightly with GYRO.
  = Added tool to import Solomon's vpol_2 data.
  = Miscellaneous additional cleanups.
  = Added tool for reading ASTRA/excel data.

VERSION 7.4 (22 October 2008)

- Important changes:
  - Added new collision algorithm (ORB_RBF=3,5,7).
  - Using ORB_RBF=0 will use old method for comparison.
  - Final version before stripping out old collision method.
- Additional changes:
  - Added V' data to profile_sim.out.
  - Third ion added to gyro_sub.
  - Small correction to profile flattening logic.

VERSION 8.0 (29 January 2009)

- New RBF collision scheme.  Select order with ORD_RBF=3,5 (maybe 7).
- Rewrite of get_storage -> gyro_memory_usage.
- Added integral ballooning mode diagnostic for area under 
  real and imaginary parts of eigenmode (balloon_int.out).
- Updated data for regression tests with collisions (N5-d3d, etc). 
- Now ETG with adiabatic ions is computed with correct factor 
  of Z_eff in the Poisson equation.
- Franklin install files updated for quad-core functionality.
- Removed "skipinput" from gyro_do argument list.
- tools:
  = added eq_tools/eliteeq for direct interface to EFIT via eliteeq.
  = added eq_tools/fluxfit for fitting eliteeq flux surfaces to 
    Miller or fully numerical shape
  = added eq2gyro tool to map it all to INPUT_profiles.
- GEO:
  = Ability to treat ** general numerical equilibria ** generated 
    by eliteeq/fluxfit.
  = Code is passed through GEO_do
  = Formalism and results are indentical with Miller in the 
    limit that the Miller parameterication is accurate.
  = Delta1 parameterization of up-down triangularity asymmetry removed.
    Delta1 replaced by squareness parameter zeta in INPUT_profiles.
    zmag parameter describing flux-surface elevation added to
    INPUT_profiles (cooresponds to Z0 in documentation).
    ** NOTE: v8.0 iterdb_to_gyro still writes delta1, does NOT **
    ** write zeta or zmag. **

VERSION 8.1 (25 March 2009)

- flat_profile_flag now always reflects flatness of profiles.
- Fixed rho_star -> rho_s in data written by write_input.
- iterdb2gyro:
  = Source completely rewritten
  = Can read iterdb in NetCDF or text format.
  = Interface to GATO to generate INPUT_profiles.geo.
  = (BUG) Fixed power computation bug introduced in 8.0 (do not 
    use powers computed with gyro-8.0).
  = zeta and zmag now output instead of delta1.
  = modified build flags to link with shared NetCDF libraries.
- releasing this version to prepare for major upgrades to 
  rotation, collisions and linear eigensolver.

VERSION 8.2 (6 July 2009)

- gyro_interface introduced to simplify calling from TGYRO.
- Fixed very small error in gyro_conserve_number.
- New facility for automated regression testing: "gyro -r".
- Added plotting of parallel velocity fluctuations: moment_v.out.
- Deprecated OUTPUT_METHOD in favour of PLOT_U_FLAG, PLOT_N_FLAG, 
  PLOT_E_FLAG, PLOT_V_FLAG.
- Added new INPUT variable SIGNB to control sign of B.
- Added new INPUT variable GEO_BETA_METHOD to control 
  finite-pressure effects in equilibrium.
- Added platform files for OSG.
- Set restart_method=0 if restart_method>1 and no restart data 
  is available.
- Computation of n=0 moments moved to get_moments_plot, and 
  then get_moments_plot -> gyro_moments_plot.  
- zm.out renamed to moment_zero.out.
- More files renamed with gyro_ prefix.
- Removed a significant number of write_* routines, and 
  replaced with generic write_local_real routine:
  = Changed index write order in zm(:,:,:) (now the array is 
    written in natural order).  Actual index order thus needed
    to be reversed in vugyro.
  = Changed GYRO internal index order on diff_i, etc (all 
    diffusivity-related real arrays).
- iterdb2gyro:
  = Extra sign added to BT_EXP for iterdb files (DIII-D convention 
    is B is positive CCW when looking down on torus, whereas GYRO 
    convention is B is positive CW looking down).  Plasma state 
    convention is the same as GYRO.  
  = Fixed plasma state electron and ion power calculation, and added 
    Epot (electrostatic potential) read to determine Er.
- EIGEN
  = Eigenvalue capability added!

VERSION 8.3 (12 November 2009)
 
- Finite delta_B_parallel (A_perp) fluctuations:
  - enabled by setting EM_APERP_FLAG=1.
- Dramatic improvement/unification of ELECTRON_METHOD=3,4.  
  - the meaning of _ELECTRON in INPUT is consistent.
  - in regions when model accuracy is good, one can obtain identical 
    results from ELECTRON_METHOD=2,4 or ELECTRON_METHOD=3,4.
- Now read EXPRO_w0 and EXPRO_w0p in make_experimental_profiles. 
- Deprecated ELECTRON_OVERLAY_METHOD=1 and removed internal variable.  Now one 
  must always specify electron parameters for the electrons.
- Changed behaviour for ELECTRON_ORBIT_UPWIND when ELECTRON_METHOD=4.  The 
  previous behaviour forced ELECTRON_ORBIT_UPWIND -> 1.0 in this case. 
  Now, we use the value specified in INPUT.  WARNING: there is some Ampere 
  cancellation error when using ELECTRON_ORBIT_UPWIND > 0.
- New parameter GEO_BETAPRIME_SCALE, which independently controls the
  beta-prime input to GEO. 
- Changed name: GEO_BETA_METHOD -> GEO_GRADBCURV_FLAG.
- Removed all old EMF code.  EMF_FLAG remains so as not to break code.
- Removed some useless datafiles: write_timing.out, linear_summary.out.
- Added k_perp^2(n) diagnostic: k_perp_squared.out.
- Added option to parse ASTRA data (E. Granstedt).  See code in
  tools/iterdb_read/astra.
- Added option to pull data from TRANSP server (L. Peterson).  See code in
  tools/iterdb_read/transp
- Added capability to plot ballooning modes with theta0 > 0.
- Added parameter N_FIELD to control number of fields.

VERSION 9.0 (3 March 2010)

- Field eigenvalue solver capability added (fieldeigen_*).
  - Enable with LINSOLVE_METHOD=3 (see Wiki for more documentation).
- Introduced new INPUT parameter: COLLISION_METHOD.  Choices are
   COLLISION_METHOD=1: original method, which tries to compute the 
     explicit change in A_parallel.  This has a problem.
   COLLISION_METHOD=2: new method (and new default) which does not 
     compute the explicit change in the fields.  This appears to not 
     have the same problem as 1.  Linearly, one can always compare 
     with the eigenvalue solver, which is "exact".
   COLLISION_METHOD=3: experimental (unsupported)
- Generalized INPUT parser for 5 ion species.
- Complete overhaul of regression suite (gyro -g), with more systematic 
  construciton of cases.
- Added gyro/peek subdirectory to generate a GYRO sim "quick summary".
- Improved intelligence of INPUT parser (in python/gyro_utils.py) to handle 
  more complex comments and extra writespace.
- Introduced unified loop coding for periodic/nonperiodic BCs.
- Use 3-point rule for calculation of exchange time derivative.
- Added output file gbflux_mom.out to plot the three-component 
  breakdown (parallel, perp and convective) of the momentum 
  flux.  This data is averaged over space, so only 3*n_kinetic 
  columns appear, where n_kinetic is the number of kinetic species.

VERSION 9.1 (13 August 2010)

- Added toroidal field/plasma current (ipccw/btccw) direction control.
- Correct exchange calculation (ROTATION_METHOD=3) with ExB shear.
- New entropy (Sugama theory) calculation.
- Fixed interface error: gyro_geo_betaprime_scale_in changed from int 
  to real.
- Added GKEIGEN regression case.
- EXPRO:
  = Added variables: EXPRO_qn, EXPRO_bt0, EXPRO_bp0, 
    EXPRO_poloidalfluxover2pi, etc.
  = Added general geometry option.
- GEO:
  = Switched to extensible module-type interface.
- Added CARVER, HOPPER, LOKI, PPPL platform files.
- iterdb2gyro
  = Code to read Solomon's CER data.  
  = Ability to read peqdsk.
- Better data descriptions (rho_sD) in run.out.
- TOOLS:
  = ITERDB netcdf: iterdd2gyro now adds beam ions to ion species.
- Last version before git.
- Another line
- Line 2
- Line 3
- Line 4
- Emily changes
